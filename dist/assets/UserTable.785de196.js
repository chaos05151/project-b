import{ac as K,o as b,a4 as D,b as t,_ as Q,g as _,f as R,bw as y,c as x,a as C,w as c,bx as E,e as v,r as h,U,aJ as M,b6 as S,bq as H}from"./index.3430d699.js";import{a as X,b as Z}from"./product.c1757ced.js";import{f as A,a as $,r as ee}from"./user.1e5e51b7.js";import{e as ae}from"./export2excel.a0c92898.js";import{h as N}from"./moment.9709ab41.js";import"./request.79f6b612.js";var z=K({name:"Search"});const te={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},le=t("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704z"},null,-1);function oe(n,a,i,e,P,w){return b(),D("svg",te,[le])}z.render=oe;z.__file="packages/components/Search.vue";var ne=z;const m=_(""),p=_(""),s=_(""),se=_(0),F=_([]),I=_([]),k=_(0),B=_(""),re=_(""),de=_("\u4E00\u7EA7\u6E38\u620F"),Y=_({}),r=R({keywords:"",page_index:1,page_size:10});let J=_([]),O=_([]),ie=_([{value:"-1",label:"\u5168\u90E8"},{value:"1",label:"\u5DF2\u63D0\u73B0\u7528\u6237"},{value:"0",label:"\u672A\u63D0\u73B0\u7528\u6237"}]);const d=n=>{A(n).then(a=>{a.status==200?(F.value=a.data.lists.map(i=>({...i,is_buy:i.is_buy==1?"\u662F":"\u5426",created_at:N(i.created_at).format("YYYY-MM-DD HH:mm:ss")})),k.value=a.data.total_count,Y.value=JSON.parse(JSON.stringify(n)).catch(()=>{})):y.error(a==null?void 0:a.message)}).catch(()=>{})},q=()=>{m.value="",p.value="",s.value="",B.value="",r.keywords=""},ce=()=>{X().then(n=>{J.value=n.data}).catch(()=>{})},ue=n=>{Z({main_product_id:n}).then(i=>{O.value=i.data}).catch(()=>{})},_e=n=>{$(n).then(a=>{a.status==200&&(y.success("\u52A0\u5165\u9ED1\u540D\u5355\u6210\u529F\uFF01"),d(r))}).catch(()=>{})},pe=n=>{ee(n).then(a=>{a.status==200&&(y.success("\u79FB\u51FA\u9ED1\u540D\u5355\u6210\u529F\uFF01"),d(r))}).catch(()=>{})},me=n=>{if(n)return!!/^\d+(\.{0,1}\d+){0,1}$/.test(n)},ve={name:"basetable",setup(){q(),ce(),d(r);const n=l=>{E.confirm("\u786E\u5B9A\u52A0\u5165\u9ED1\u540D\u5355\uFF1F","\u63D0\u793A",{type:"warning"}).then(()=>{_e(l)}).catch(()=>{})},a=l=>{E.confirm("\u786E\u5B9A\u79FB\u51FA\u9ED1\u540D\u5355\uFF1F","\u63D0\u793A",{type:"warning"}).then(()=>{pe(l)}).catch(()=>{})},i=()=>{if(m.value==-1)if(p.value==-1)if(s.value&&s.value>=0){const l={withdraw_user:s.value,...r};d(l)}else d(r);else if(p.value&&p.value>0)if(s.value&&s.value>=0){const l={product_id:p.value,withdraw_user:s.value,...r};d(l)}else{const l={product_id:p.value,...r};d(l)}else if(s.value&&s.value>=0){const l={withdraw_user:s.value,...r};d(l)}else d(r);else if(m.value&&m.value>0){if(p.value==-1)if(s.value&&s.value>=0){const l={main_product_id:m.value,withdraw_user:s.value,...r};d(l)}else{const l={main_product_id:m.value,...r};d(l)}else if(p.value&&p.value>0)if(s.value&&s.value>=0){const l={product_id:p.value,withdraw_user:s.value,...r};d(l)}else{const l={product_id:p.value,...r};d(l)}else if(s.value&&s.value>=0){const l={main_product_id:m.value,withdraw_user:s.value,...r};d(l)}else{const l={main_product_id:m.value,...r};d(l)}ue(m.value)}else if(s.value&&s.value>=0){const l={withdraw_user:s.value,...r};d(l)}else d(r)};return{tableData:F,tableExportData:I,removeBlackList:a,addBlackList:n,product_type:de,Search:ne,checkNonnegative:me,searchByIdNickNameIpMobile:()=>{B.value?(r.keywords=B.value,i()):(r.keywords="",i())},idnicknamephonemobile:B,options:J,suboptions:O,useroptions:ie,main_product_name_selected:m,product_name_selected:p,main_product_value_select:re,check_main_product_name:se,getProductAndDataList:i,getDataById:()=>{i()},getWithdrawUser:()=>{i()},withdraw_user_selected:s,handlePageChange:l=>{r.page_index=l,i()},query:r,pageTotal:k,clearOptions:q}},methods:{withDraw(){this.$router.push("/withdraw")},userDetail(n){this.$router.push({name:"userdetail",params:{wechat_user_id:n}})},blackList(){this.$router.push("/blacklist")},userFeedback(){this.$router.push("/feedback")},exportExcel(){Y.value.page_size=k.value?k.value<=1e4?k.value:1e4:10,A(Y.value).then(n=>{if(n.status==200){I.value=n.data.lists.map(e=>({...e,is_buy:e.is_buy==1?"\u662F":"\u5426",created_at:N(e.created_at).format("YYYY-MM-DD HH:mm:ss")}));const a=["\u4E00\u7EA7\u6E38\u620F","\u4E8C\u7EA7\u6E38\u620F","\u7528\u6237id","\u6570\u76DFid","\u662F\u5426\u4E70\u91CF\u7528\u6237","\u7528\u6237\u540D","\u624B\u673A\u53F7","\u7D2F\u79EF\u4F63\u91D1","\u5DF2\u63D0\u73B0\u4F63\u91D1","\u5DF2\u63D0\u73B0\u6B21\u6570","\u6CE8\u518Cip","ip\u5730\u5740","\u6CE8\u518C\u65F6\u95F4"],i=I.value.map(e=>({main_product_name:e.main_product_name,product_name:e.product_name,id:e.id,oaid:e.oaid,is_buy:e.is_buy==1?"\u662F":"\u5426",nickname:e.nickname,tel:e.tel,reward:e.reward,withdraw_reward:e.withdraw_reward,withdraw_times:e.withdraw_times,ip:e.ip,ip_address:e.ip_address,created_at:N(e.created_at).format("YYYY-MM-DD HH:mm:ss")}));ae(i,"UserTable",a,"UserTable")}else n.message?y.error(n.message):y.error("\u540E\u7AEFapi\u63A5\u53E3\u5F02\u5E38\uFF01")})}}},he={class:"crumbs"},be=v("\u98CE\u63A7\u7CFB\u7EDF"),we=v("\u7528\u6237\u7BA1\u7406"),fe={class:"container"},ge={class:"handle-box"},ke=v("\xA0\xA0 "),ye=v("\u63D0\u73B0\u8BBE\u7F6E"),xe=v("\u67E5\u770B\u9ED1\u540D\u5355"),Ce=v("\u7528\u6237\u53CD\u9988"),De=v("\u5BFC\u51FAExcel"),Be=v("\u8BE6\u60C5 "),Le=v(" \u52A0\u5165\u9ED1\u540D\u5355 "),Ve=v(" \u79FB\u51FA\u9ED1\u540D\u5355 "),Ue={class:"pagination"};function Me(n,a,i,e,P,w){const L=h("el-breadcrumb-item"),l=h("el-breadcrumb"),g=h("el-option"),V=h("el-select"),W=h("el-input"),f=h("el-button"),u=h("el-table-column"),j=h("el-table"),G=h("el-pagination");return b(),x("div",null,[C("div",he,[t(l,{separator:"/"},{default:c(()=>[t(L,null,{default:c(()=>[be]),_:1}),t(L,null,{default:c(()=>[we]),_:1})]),_:1})]),C("div",fe,[C("div",ge,[t(V,{style:{width:"12%"},modelValue:e.main_product_name_selected,"onUpdate:modelValue":a[0]||(a[0]=o=>e.main_product_name_selected=o),placeholder:"\u4E00\u7EA7\u6E38\u620F",class:"m-2",onChange:e.getProductAndDataList},{default:c(()=>[t(g,{label:"\u5168\u90E8",value:"-1"}),(b(!0),x(U,null,M(e.options,o=>(b(),D(g,{key:o.id,label:o.main_product_name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),t(V,{style:{width:"12%"},modelValue:e.product_name_selected,"onUpdate:modelValue":a[1]||(a[1]=o=>e.product_name_selected=o),placeholder:"\u4E8C\u7EA7\u6E38\u620F",class:"m-2",onChange:e.getDataById},{default:c(()=>[t(g,{label:"\u5168\u90E8",value:"-1"}),(b(!0),x(U,null,M(e.suboptions,o=>(b(),D(g,{key:o.product_id,label:o.product_name,value:o.product_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),t(V,{style:{width:"11%"},modelValue:e.withdraw_user_selected,"onUpdate:modelValue":a[2]||(a[2]=o=>e.withdraw_user_selected=o),placeholder:"\u63D0\u73B0\u7528\u6237",class:"m-2",onChange:e.getWithdrawUser},{default:c(()=>[(b(!0),x(U,null,M(e.useroptions,o=>(b(),D(g,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),t(W,{modelValue:e.idnicknamephonemobile,"onUpdate:modelValue":a[3]||(a[3]=o=>e.idnicknamephonemobile=o),onInput:e.searchByIdNickNameIpMobile,style:{width:"200px"},class:"w-50 m-2",placeholder:"\u8BF7\u8F93\u5165id/\u7528\u6237\u540D/\u624B\u673A\u53F7/ip"},null,8,["modelValue","onInput"]),ke,t(f,{type:"primary",onClick:a[4]||(a[4]=o=>w.withDraw())},{default:c(()=>[ye]),_:1}),t(f,{type:"primary",onClick:a[5]||(a[5]=o=>w.blackList())},{default:c(()=>[xe]),_:1}),t(f,{type:"primary",onClick:a[6]||(a[6]=o=>w.userFeedback())},{default:c(()=>[Ce]),_:1}),t(f,{type:"primary",onClick:a[7]||(a[7]=o=>w.exportExcel())},{default:c(()=>[De]),_:1})]),t(j,{data:e.tableData,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:c(()=>[t(u,{prop:"main_product_name",label:"\u4E00\u7EA7\u6E38\u620F"}),t(u,{prop:"product_name",label:"\u4E8C\u7EA7\u6E38\u620F"}),t(u,{prop:"id",label:"\u7528\u6237id"}),t(u,{prop:"oaid",label:"\u6570\u76DFid"}),t(u,{prop:"is_buy",label:"\u662F\u5426\u4E70\u91CF\u7528\u6237"}),t(u,{prop:"nickname",label:"\u7528\u6237\u540D"}),t(u,{prop:"tel",label:"\u624B\u673A\u53F7"}),t(u,{sortable:"",prop:"reward",label:"\u7D2F\u79EF\u4F63\u91D1"}),t(u,{sortable:"",prop:"withdraw_reward",label:"\u5DF2\u63D0\u73B0\u4F63\u91D1"}),t(u,{sortable:"",prop:"withdraw_times",label:"\u5DF2\u63D0\u73B0\u6B21\u6570"}),t(u,{prop:"ip",label:"\u6CE8\u518Cip"}),t(u,{prop:"ip_address",label:"ip\u5730\u5740"}),t(u,{prop:"created_at",label:"\u6CE8\u518C\u65F6\u95F4"}),t(u,{label:"\u64CD\u4F5C",width:"220",align:"center"},{default:c(o=>[t(f,{type:"text",icon:"el-icon-link",onClick:T=>w.userDetail(o.row.id)},{default:c(()=>[Be]),_:2},1032,["onClick"]),S(t(f,{type:"text",icon:"el-icon-delete",class:"red",onClick:T=>e.addBlackList(o.row.id)},{default:c(()=>[Le]),_:2},1032,["onClick"]),[[H,o.row.blacklisted!=1]]),S(t(f,{type:"text",icon:"el-icon-edit",onClick:T=>e.removeBlackList(o.row.id)},{default:c(()=>[Ve]),_:2},1032,["onClick"]),[[H,o.row.blacklisted==1]])]),_:1})]),_:1},8,["data"]),C("div",Ue,[t(G,{background:"",layout:"total, prev, pager, next","current-page":e.query.page_index,"page-size":e.query.page_size,total:e.pageTotal,onCurrentChange:e.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])])])}var Ee=Q(ve,[["render",Me],["__scopeId","data-v-60eb0f48"]]);export{Ee as default};
