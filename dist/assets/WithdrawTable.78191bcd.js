import{_ as ea,g as _,f as N,u as la,o as v,c as D,a as U,b as e,w as d,b6 as q,bq as W,bw as k,e as w,r as n,U as B,aJ as S,a4 as I,t as J}from"./index.3430d699.js";import{a as da,b as oa}from"./product.c1757ced.js";import{w as ra,j as na,k as ia}from"./user.1e5e51b7.js";import"./request.79f6b612.js";const h=_(""),x=_(""),g=N({page_index:1,page_size:10}),H=_(0);_("");_("");const p=N({}),m=N({}),sa=_(null),K=_(!1),_a=_(!1),Q=_([]),ua=_(""),ma=_("\u4E00\u7EA7\u6E38\u620F");let X=_([]),E=_([]),Y=_([]);const C=(r,l)=>{ra(r).then(u=>{u.status==200?(Q.value=u.data.lists.filter(a=>a.config_type!=0).map(a=>({...a,biomass_login_status:a.biomass_login_status==1?"\u5141\u8BB8":"\u7981\u6B62",user_withdrawal_status:a.user_withdrawal_status==1?"\u5141\u8BB8":"\u7981\u6B62"})),H.value=l==1?u.data.total_count:u.data.total_count-1,p.value=u.data.lists.filter(a=>a.config_type==0)[0],p.value.config_type==0&&(K.value=!0,p.user_withdrawal_status=p.value.user_withdrawal_status==1,p.biomass_login_status=p.value.biomass_login_status==1,p.withdrawal_audit_standard=p.value.withdrawal_audit_standard,p.withdrawal_count=p.value.withdrawal_count)):k.error(u==null?void 0:u.message)}).catch(()=>{})},wa=()=>{da().then(r=>{X.value=r.data,Y.value=r.data}).catch(()=>{})},ca=r=>{oa({main_product_id:r}).then(u=>{E.value=u.data}).catch(()=>{})},O=r=>{na(r).then(l=>{l.status==200?(k.success("\u6DFB\u52A0\u63D0\u73B0\u914D\u7F6E\u6210\u529F"),C(g)):l.status==-1&&k.error("\u6B64\u6E38\u620F\u914D\u7F6E\u5DF2\u5B58\u5728\uFF01")})},fa=(r,l)=>{ia(r,l).then(u=>{u.status==200&&(k.success("\u4FEE\u6539\u63D0\u73B0\u914D\u7F6E\u6210\u529F"),C(g))})},G=r=>r?/^\d+(\.{0,1}\d+){0,1}$/.test(r)?!0:(k.error("\u8BF7\u5148\u9009\u62E9\u4EA7\u54C1\uFF01"),!1):(k.error("\u8BF7\u9009\u62E9\u6E38\u620F\uFF01"),!1),T=r=>{if(r)return/^\d+(\.{0,1}\d+){0,1}$/.test(r)?!0:(k.error("\u8BF7\u8F93\u5165\u6570\u5B57\uFF01"),!1)},pa={name:"basetable",setup(){h.value="",x.value="";const r={};C(g),wa();const l=la(),u=(o,c,f,s)=>{l.push({name:"withdrawdetail",params:{main_product_name:o,main_product_id:c,product_id:s,product_name:f}})};let a=N({id:"",main_product_id:"",product_id:"",main_product_name:"",product_name:"",user_withdrawal_status:"",biomass_login_status:"",withdrawal_audit_standard:"",withdrawal_count:""});const z=_(!1),L=_(!1),P=(o,c)=>{Object.keys(a).forEach(f=>{f=="user_withdrawal_status"||f=="biomass_login_status"?a[f]=c[f]=="\u5141\u8BB8":a[f]=c[f]}),z.value=!0},R=()=>{L.value=!0},y=o=>{g.page_index=o,V()},A=()=>{if(z.value=!1,a.withdrawal_audit_standard&&!T(a.withdrawal_audit_standard)||a.withdrawal_count&&!T(a.withdrawal_count))return;const o={user_withdrawal_status:a.user_withdrawal_status?1:0,biomass_login_status:a.biomass_login_status?1:0,withdrawal_audit_standard:a.withdrawal_audit_standard,withdrawal_count:a.withdrawal_count};fa(a.id,o)},b=()=>{if(L.value=!1,!(m.withdrawal_audit_standard&&!T(m.withdrawal_audit_standard))&&!(m.withdrawal_count&&!T(m.withdrawal_count)))if(m.config_type)if(m.config_type==1){if(!G(h.value))return;x.value.forEach(function(o){if(!G(o))return;const c=E.value.filter(s=>s.product_id==o),f={config_type:1,main_product_id:c[0].main_product_id,main_product_name:c[0].main_product_name,product_id:c[0].product_id,product_name:c[0].product_name,user_withdrawal_status:m.user_withdrawal_status?1:0,biomass_login_status:m.biomass_login_status?1:0,withdrawal_audit_standard:m.withdrawal_audit_standard,withdrawal_count:m.withdrawal_count};O(f)}),h.value="",x.value="",E.value=""}else{const o={config_type:0,user_withdrawal_status:m.user_withdrawal_status?1:0,biomass_login_status:m.biomass_login_status?1:0,withdrawal_audit_standard:m.withdrawal_audit_standard,withdrawal_count:m.withdrawal_count};O(o)}else{k.error("\u5FC5\u987B\u9009\u62E9\u914D\u7F6E\u7C7B\u578B\uFF01");return}},V=()=>{if(x.value="",E.value="",h.value==-1||!h.value)C(g);else{const o={main_product_id:h.value,...g};C(o,1),ca(h.value)}};return{tableData:Q,pageTotal:H,editVisible:z,addVisible:L,form:p,formEdit:a,formAdd:m,showWithdraw:K,withdrawShow:_a,handleEdit:P,handleAdd:R,saveEdit:A,saveAdd:b,product_type:ma,options:X,suboptions:E,addoptions:Y,main_product_name_selected:h,product_name_selected:x,main_product_value_select:ua,getProductAndDataList:V,getDataById:()=>{if(h.value==-1||!h.value)C(g);else if(x.value==-1){const o={main_product_id:h.value,...g};C(o,1)}else{const o={product_id:x.value,...g};C(o,1)}},handlePageChange:y,query:g,rules:r,form:p,formRef:sa,router:l,withdrawDetail:u}}},ha={class:"crumbs"},ba=w("\u98CE\u63A7\u7CFB\u7EDF"),ga=w("\u63D0\u73B0\u914D\u7F6E"),Va={class:"container"},va={class:"handle-box"},ya=w("\xA0\xA0 "),Ca=w(" \u5168\u5C40\u914D\u7F6E"),ka=w("\u63D0\u73B0\u8BBE\u7F6E"),xa=w("\u63D0\u73B0\u7533\u8BF7 "),Aa=w("\u63D0\u73B0\u8BBE\u7F6E "),Ua={class:"pagination"},Da={class:"dialog-footer"},Ea=w("\u53D6 \u6D88"),za=w("\u786E \u5B9A"),La=w("\u6240\u6709\u9879\u76EE"),Pa=w("\u6307\u5B9A\u9879\u76EE"),Ba={class:"dialog-footer"},Sa=w("\u53D6 \u6D88"),Ia=w("\u786E \u5B9A");function Ta(r,l,u,a,z,L){const P=n("el-breadcrumb-item"),R=n("el-breadcrumb"),y=n("el-option"),A=n("el-select"),b=n("el-button"),V=n("el-switch"),i=n("el-form-item"),o=n("el-input"),c=n("el-form"),f=n("el-drawer"),s=n("el-table-column"),j=n("el-tag"),Z=n("el-table"),$=n("el-pagination"),M=n("el-dialog"),F=n("el-radio"),aa=n("el-radio-group");return v(),D("div",null,[U("div",ha,[e(R,{separator:"/"},{default:d(()=>[e(P,null,{default:d(()=>[ba]),_:1}),e(P,null,{default:d(()=>[ga]),_:1})]),_:1})]),U("div",Va,[U("div",va,[e(A,{modelValue:a.main_product_name_selected,"onUpdate:modelValue":l[0]||(l[0]=t=>a.main_product_name_selected=t),placeholder:"\u4E00\u7EA7\u6E38\u620F",class:"m-2",onChange:a.getProductAndDataList},{default:d(()=>[e(y,{label:"\u5168\u90E8",value:"-1"}),(v(!0),D(B,null,S(a.options,t=>(v(),I(y,{key:t.id,label:t.main_product_name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),e(A,{modelValue:a.product_name_selected,"onUpdate:modelValue":l[1]||(l[1]=t=>a.product_name_selected=t),placeholder:"\u4E8C\u7EA7\u6E38\u620F",class:"m-2",onChange:a.getDataById},{default:d(()=>[e(y,{label:"\u5168\u90E8",value:"-1"}),(v(!0),D(B,null,S(a.suboptions,t=>(v(),I(y,{key:t.product_id,label:t.product_name,value:t.product_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),ya,q(e(b,{type:"primary",onClick:l[2]||(l[2]=t=>a.withdrawShow=!0)},{default:d(()=>[Ca]),_:1},512),[[W,a.showWithdraw]]),e(b,{type:"primary",onClick:a.handleAdd},{default:d(()=>[ka]),_:1},8,["onClick"]),e(f,{modelValue:a.withdrawShow,"onUpdate:modelValue":l[7]||(l[7]=t=>a.withdrawShow=t),title:"\u63D0\u73B0\u5168\u5C40\u914D\u7F6E\u4FE1\u606F\uFF1A",direction:"rtl",size:"50%"},{default:d(()=>[e(c,{ref:"formRef",model:a.form,"label-width":"280px"},{default:d(()=>[e(i,{label:"\u662F\u5426\u5141\u8BB8\u6240\u6709\u7528\u6237\u63D0\u73B0",prop:"user_withdrawal_status"},{default:d(()=>[e(V,{disabled:"",modelValue:a.form.user_withdrawal_status,"onUpdate:modelValue":l[3]||(l[3]=t=>a.form.user_withdrawal_status=t)},null,8,["modelValue"])]),_:1}),e(i,{label:"\u662F\u5426\u5141\u8BB8\u81EA\u7136\u91CF\u767B\u5F55",prop:"biomass_login_status"},{default:d(()=>[e(V,{disabled:"",modelValue:a.form.biomass_login_status,"onUpdate:modelValue":l[4]||(l[4]=t=>a.form.biomass_login_status=t)},null,8,["modelValue"])]),_:1}),e(i,{label:"\u63D0\u73B0\u5BA1\u6838\u6807\u51C6",prop:"withdrawal_audit_standard"},{default:d(()=>[e(o,{disabled:"",style:{width:"150px"},modelValue:a.form.withdrawal_audit_standard,"onUpdate:modelValue":l[5]||(l[5]=t=>a.form.withdrawal_audit_standard=t)},null,8,["modelValue"])]),_:1}),e(i,{label:"\u63D0\u73B0\u6B21\u6570",prop:"withdrawal_count"},{default:d(()=>[e(o,{disabled:"",style:{width:"150px"},modelValue:a.form.withdrawal_count,"onUpdate:modelValue":l[6]||(l[6]=t=>a.form.withdrawal_count=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),e(Z,{data:a.tableData,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:d(()=>[e(s,{prop:"main_product_id",label:"\u7236\u6E38\u620FID"}),e(s,{prop:"main_product_name",label:"\u7236\u6E38\u620F"}),e(s,{prop:"product_id",label:"\u5B50\u6E38\u620FID"}),e(s,{prop:"product_name",label:"\u5B50\u6E38\u620F"}),e(s,{prop:"unaudit_orders_count",label:"\u672A\u5BA1\u6838\u8BA2\u5355\u6570"}),e(s,{prop:"unaudit_reward_sum",label:"\u672A\u5BA1\u6838\u603B\u91D1\u989D"}),e(s,{prop:"apply_users_count",label:"\u7533\u8BF7\u4EBA\u6570"}),e(s,{prop:"user_withdrawal_status",label:"\u7528\u6237\u63D0\u73B0"},{default:d(t=>[e(j,{type:t.row.user_withdrawal_status==="\u5141\u8BB8"?"":t.row.user_withdrawal_status==="\u7981\u6B62"?"danger":""},{default:d(()=>[w(J(t.row.user_withdrawal_status),1)]),_:2},1032,["type"])]),_:1}),e(s,{prop:"biomass_login_status",label:"\u81EA\u7136\u91CF\u767B\u5F55"},{default:d(t=>[e(j,{type:t.row.biomass_login_status==="\u5141\u8BB8"?"":t.row.biomass_login_status==="\u7981\u6B62"?"danger":""},{default:d(()=>[w(J(t.row.biomass_login_status),1)]),_:2},1032,["type"])]),_:1}),e(s,{prop:"withdrawal_audit_standard",label:"\u63D0\u73B0\u5BA1\u6838\u6807\u51C6"}),e(s,{prop:"withdrawal_count",label:"\u5355\u7528\u6237\u5F53\u5929\u63D0\u73B0\u6B21\u6570"}),e(s,{label:"\u64CD\u4F5C",width:"220",align:"center"},{default:d(t=>[e(b,{type:"text",icon:"el-icon-link",onClick:ta=>a.withdrawDetail(t.row.main_product_name,t.row.main_product_id,t.row.product_name,t.row.product_id)},{default:d(()=>[xa]),_:2},1032,["onClick"]),e(b,{type:"text",icon:"el-icon-edit",onClick:ta=>a.handleEdit(t.row.id,t.row)},{default:d(()=>[Aa]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),U("div",Ua,[e($,{background:"",layout:"total, prev, pager, next","current-page":a.query.page_index,"page-size":a.query.page_size,total:a.pageTotal,onCurrentChange:a.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),e(M,{title:"\u7F16\u8F91\u63D0\u73B0\u914D\u7F6E",modelValue:a.editVisible,"onUpdate:modelValue":l[13]||(l[13]=t=>a.editVisible=t),width:"60%"},{footer:d(()=>[U("span",Da,[e(b,{onClick:l[12]||(l[12]=t=>a.editVisible=!1)},{default:d(()=>[Ea]),_:1}),e(b,{type:"primary",onClick:a.saveEdit},{default:d(()=>[za]),_:1},8,["onClick"])])]),default:d(()=>[e(c,{ref:"formRef",rules:a.rules,model:a.formEdit,"label-width":"280px"},{default:d(()=>[e(i,{label:"\u662F\u5426\u5141\u8BB8\u6240\u6709\u7528\u6237\u63D0\u73B0",prop:"user_withdrawal_status"},{default:d(()=>[e(V,{modelValue:a.formEdit.user_withdrawal_status,"onUpdate:modelValue":l[8]||(l[8]=t=>a.formEdit.user_withdrawal_status=t)},null,8,["modelValue"])]),_:1}),e(i,{label:"\u662F\u5426\u5141\u8BB8\u81EA\u7136\u91CF\u767B\u5F55",prop:"biomass_login_status"},{default:d(()=>[e(V,{modelValue:a.formEdit.biomass_login_status,"onUpdate:modelValue":l[9]||(l[9]=t=>a.formEdit.biomass_login_status=t)},null,8,["modelValue"])]),_:1}),e(i,{label:"\u63D0\u73B0\u5BA1\u6838\u6807\u51C6",prop:"withdrawal_audit_standard"},{default:d(()=>[e(o,{style:{width:"150px"},modelValue:a.formEdit.withdrawal_audit_standard,"onUpdate:modelValue":l[10]||(l[10]=t=>a.formEdit.withdrawal_audit_standard=t)},null,8,["modelValue"])]),_:1}),e(i,{label:"\u63D0\u73B0\u6B21\u6570",prop:"withdrawal_count"},{default:d(()=>[e(o,{style:{width:"150px"},modelValue:a.formEdit.withdrawal_count,"onUpdate:modelValue":l[11]||(l[11]=t=>a.formEdit.withdrawal_count=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"]),e(M,{title:"\u65B0\u589E\u63D0\u73B0\u914D\u7F6E",modelValue:a.addVisible,"onUpdate:modelValue":l[22]||(l[22]=t=>a.addVisible=t),width:"60%"},{footer:d(()=>[U("span",Ba,[e(b,{onClick:l[21]||(l[21]=t=>a.addVisible=!1)},{default:d(()=>[Sa]),_:1}),e(b,{type:"primary",onClick:a.saveAdd},{default:d(()=>[Ia]),_:1},8,["onClick"])])]),default:d(()=>[e(c,{ref:"formRef",rules:a.rules,model:a.formAdd,"label-width":"280px"},{default:d(()=>[e(i,{label:"\u914D\u7F6E\u7C7B\u578B",prop:"config_type"},{default:d(()=>[e(aa,{modelValue:a.formAdd.config_type,"onUpdate:modelValue":l[14]||(l[14]=t=>a.formAdd.config_type=t)},{default:d(()=>[e(F,{label:"0"},{default:d(()=>[La]),_:1}),e(F,{label:"1"},{default:d(()=>[Pa]),_:1})]),_:1},8,["modelValue"])]),_:1}),q(e(i,{label:"\u4E00\u7EA7\u6E38\u620F",prop:"main_product_name_selected"},{default:d(()=>[e(A,{modelValue:a.main_product_name_selected,"onUpdate:modelValue":l[15]||(l[15]=t=>a.main_product_name_selected=t),placeholder:"\u4E00\u7EA7\u6E38\u620F",class:"m-2",onChange:a.getProductAndDataList},{default:d(()=>[(v(!0),D(B,null,S(a.options,t=>(v(),I(y,{key:t.id,label:t.main_product_name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1},512),[[W,a.formAdd.config_type==1]]),q(e(i,{label:"\u4E8C\u7EA7\u6E38\u620F",prop:"product_name_selected"},{default:d(()=>[e(A,{multiple:"",modelValue:a.product_name_selected,"onUpdate:modelValue":l[16]||(l[16]=t=>a.product_name_selected=t),placeholder:"\u4E8C\u7EA7\u6E38\u620F",class:"m-2"},{default:d(()=>[(v(!0),D(B,null,S(a.suboptions,t=>(v(),I(y,{key:t.product_id,label:t.product_name,value:t.product_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},512),[[W,a.formAdd.config_type==1]]),e(i,{label:"\u662F\u5426\u5141\u8BB8\u6240\u6709\u7528\u6237\u63D0\u73B0",prop:"user_withdrawal_status"},{default:d(()=>[e(V,{modelValue:a.formAdd.user_withdrawal_status,"onUpdate:modelValue":l[17]||(l[17]=t=>a.formAdd.user_withdrawal_status=t)},null,8,["modelValue"])]),_:1}),e(i,{label:"\u662F\u5426\u5141\u8BB8\u81EA\u7136\u91CF\u767B\u5F55",prop:"biomass_login_status"},{default:d(()=>[e(V,{modelValue:a.formAdd.biomass_login_status,"onUpdate:modelValue":l[18]||(l[18]=t=>a.formAdd.biomass_login_status=t)},null,8,["modelValue"])]),_:1}),e(i,{label:"\u63D0\u73B0\u5BA1\u6838\u6807\u51C6",prop:"withdrawal_audit_standard"},{default:d(()=>[e(o,{style:{width:"150px"},modelValue:a.formAdd.withdrawal_audit_standard,"onUpdate:modelValue":l[19]||(l[19]=t=>a.formAdd.withdrawal_audit_standard=t)},null,8,["modelValue"])]),_:1}),e(i,{label:"\u63D0\u73B0\u6B21\u6570",prop:"withdrawal_count"},{default:d(()=>[e(o,{style:{width:"150px"},modelValue:a.formAdd.withdrawal_count,"onUpdate:modelValue":l[20]||(l[20]=t=>a.formAdd.withdrawal_count=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])}var ja=ea(pa,[["render",Ta],["__scopeId","data-v-1f19467c"]]);export{ja as default};
