import{_ as q,r as p,D as E,o as Q,a1 as R,l as m,e as d,a as u,p as v,k as o,t as h,j as l,c as Y,m as B,F as $,a2 as W,z as V,a3 as X,h as z,y as j,a4 as Z,A as ee,B as ae,V as le,a5 as te}from"./index.3fee5d13.js";import{h as I}from"./moment.9709ab41.js";import{s as A}from"./showButton.83421764.js";const oe={class:"dialog-footer"},ne=V("\u53D6 \u6D88"),se=V("\u786E \u5B9A"),de={__name:"addversiontable",props:{addVisible:{default:!1}},emits:["update-add","update-addVisible"],setup(g,{emit:D}){const C=t=>t?/^([0-9]\d|[0-9])(.([0-9]\d|\d)){2}$/.test(t)?!0:(m.error("\u7248\u672C\u53F7\u683C\u5F0F\u4E3A\u6570\u5B57\u5982:x.x.x"),!1):(m.error("\u8BF7\u9009\u62E9\u7248\u672C"),!1),M=p([]),a=E({add_product_name_selected:"",add_channel_name_selected:"",add_versions_b:"",add_versions_c:"",add_uptime:""}),x=p([]),U=p(""),_=async()=>{if(D("update-addVisible",!1),a.add_uptime&&a.add_uptime<I().format("YYYY-MM-DD HH:mm:ss")){m.error("\u9884\u671F\u4E0A\u7EBF\u65F6\u95F4\u4E0D\u80FD\u5728\u5F53\u524D\u65F6\u95F4\u4E4B\u524D\uFF01");return}if(!C(a.add_versions_b)||!C(a.add_versions_c))return;const t={product_id:a.add_product_name_selected,channel:a.add_channel_name_selected,versions_b:a.add_versions_b,versions_c:a.add_versions_c,uptime:a.add_uptime?a.add_uptime:I().format("YYYY-MM-DD HH:mm:ss")};await X(t),m.success("\u65B0\u589E\u6210\u529F");for(const n in a)a[n]&&(a[n]="");D("update-add")};Q(()=>{i()});const i=async()=>{try{const t=await R();x.value=t.data.games,M.value=t.data.channels}catch(t){console.log(t),m.error("\u670D\u52A1\u5668\u5F02\u5E38\uFF01")}},b=()=>{D("update-add")};return(t,n)=>{const H=d("el-option"),c=d("el-select"),f=d("el-form-item"),y=d("el-input"),N=d("el-date-picker"),P=d("el-form"),T=d("el-button"),s=d("el-dialog");return u(),v(s,{title:"\u65B0\u589E\u7248\u672C",width:"60%",modelValue:g.addVisible,"onUpdate:modelValue":n[5]||(n[5]=e=>W(addVisible)?addVisible.value=e:null),onClose:b},{footer:o(()=>[h("span",oe,[l(T,{onClick:b},{default:o(()=>[ne]),_:1}),l(T,{type:"primary",onClick:_},{default:o(()=>[se]),_:1})])]),default:o(()=>[l(P,{"label-width":"110px"},{default:o(()=>[l(f,{label:"\u6E38\u620F\u9009\u62E9"},{default:o(()=>[l(c,{style:{width:"18%"},modelValue:a.add_product_name_selected,"onUpdate:modelValue":n[0]||(n[0]=e=>a.add_product_name_selected=e),placeholder:"\u6E38\u620F\u9009\u62E9",class:"m-2"},{default:o(()=>[(u(!0),Y($,null,B(x.value,e=>(u(),v(H,{key:e.value,label:e.label_name,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(f,{label:"\u6E20\u9053\u9009\u62E9"},{default:o(()=>[l(c,{ref_key:"add_channel_name_selected_label",ref:U,style:{width:"18%"},modelValue:a.add_channel_name_selected,"onUpdate:modelValue":n[1]||(n[1]=e=>a.add_channel_name_selected=e),placeholder:"\u6E38\u620F\u9009\u62E9",class:"m-2"},{default:o(()=>[(u(!0),Y($,null,B(M.value,e=>(u(),v(H,{key:e.value,label:e.label_name,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(f,{label:"\u540E\u53F0\u7248\u672C"},{default:o(()=>[l(y,{style:{width:"160px"},modelValue:a.add_versions_b,"onUpdate:modelValue":n[2]||(n[2]=e=>a.add_versions_b=e)},null,8,["modelValue"])]),_:1}),l(f,{label:"\u524D\u7AEF\u7248\u672C"},{default:o(()=>[l(y,{style:{width:"160px"},modelValue:a.add_versions_c,"onUpdate:modelValue":n[3]||(n[3]=e=>a.add_versions_c=e)},null,8,["modelValue"])]),_:1}),l(f,{label:"\u9884\u671F\u4E0A\u7EBF\u65F6\u95F4",prop:"uptime"},{default:o(()=>[l(N,{modelValue:a.add_uptime,"onUpdate:modelValue":n[4]||(n[4]=e=>a.add_uptime=e),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},re=q(de,[["__file","/Users/apple/Desktop/project-b/relationship.b/src/componentsadds/addversiontable.vue"]]);const G=g=>(ee("data-v-c078e7e0"),g=g(),ae(),g),ue={class:"crumbs"},ce=V("\u98CE\u63A7\u7CFB\u7EDF"),_e=V("\u7248\u672C\u7BA1\u7406"),ie={class:"container"},pe={class:"handle-box"},me=G(()=>h("span",null,"\u5E94\u7528\u9009\u62E9\uFF1A",-1)),ve=G(()=>h("span",null,"\u6E20\u9053\u9009\u62E9\uFF1A",-1)),be=V("\xA0\xA0 "),fe=V("\u65B0\u589E\u7248\u672C"),he=V("\u5220\u9664 "),Ve={class:"pagination"},ge={__name:"VersionTable",setup(g){const D=A("product:version:view"),C=A("product:version:add");A("product:version:edit");const M=A("product:version:del"),a=p(!1),x=p([]),U=p([]),_=p(""),i=p(""),b=p([]),t=E({product_id:"",channel:"",page_index:1,page_size:10}),n=p(0);p([]);const H=s=>{t.product_id=s,i.value="",y()},c=async s=>{try{const e=await Z(s);e.status==200&&(console.log(e),U.value=await e.data.lists.map(k=>({...k,created_at:I(k.created_at).format("YYYY-MM-DD HH:mm:ss"),uptime:I(k.uptime).format("YYYY-MM-DD HH:mm:ss")})),n.value=e.data.total_count)}catch{m.error("\u670D\u52A1\u5668\u5F02\u5E38\uFF01")}a.value=!1},f=async()=>{try{const s=await R();s.status==200?(b.value=s.data.games,_.value=b.value[0].value,t.product_id=b.value[0].value,x.value=s.data.channels):s.message?m.error(s.message):m.error("\u540E\u7AEFapi\u63A5\u53E3\u5F02\u5E38\uFF01")}catch{m.error("\u670D\u52A1\u5668\u5F02\u5E38\uFF01")}y()},y=s=>{if(t.channel=s,_.value==-1&&i.value==-1)c(t);else if(_.value==-1&&i.value!=-1){const e={channel:i.value,...t};c(e)}else if(_.value!=-1&&i.value==-1){const e={product_id:_.value,...t};c(e)}else if(_.value||i.value){const e={product_id:_.value,channel:i.value,...t};c(e)}else c(t)},N=async s=>{try{await le.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F","\u63D0\u793A",{type:"warning"}),await te(s),m.success("\u5220\u9664\u7248\u672C\u6210\u529F"),await c(t)}catch{m.error("\u8BF7\u91CD\u8BD5")}},P=s=>{t.page_index=s,c(t)},T=()=>{a.value=!0};return c(),f(),(s,e)=>{const k=d("el-breadcrumb-item"),J=d("el-breadcrumb"),S=d("el-option"),L=d("el-select"),F=d("el-button"),w=d("el-table-column"),K=d("el-table"),O=d("el-pagination");return u(),Y("div",null,[h("div",ue,[l(J,{separator:"/"},{default:o(()=>[l(k,null,{default:o(()=>[ce]),_:1}),l(k,null,{default:o(()=>[_e]),_:1})]),_:1})]),h("div",ie,[h("div",pe,[me,l(L,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=r=>_.value=r),placeholder:"\u5E94\u7528\u9009\u62E9",class:"m-2",style:{width:"200px"},onChange:H},{default:o(()=>[(u(!0),Y($,null,B(b.value,r=>(u(),v(S,{key:r.value,label:r.label_name,value:r.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),ve,l(L,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=r=>i.value=r),placeholder:"\u6E20\u9053\u9009\u62E9",class:"m-2",style:{width:"200px"},onChange:y},{default:o(()=>[l(S,{label:"\u5168\u90E8",value:""}),(u(!0),Y($,null,B(x.value,r=>(u(),v(S,{key:r.value,label:r.label_name,value:r.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),be,z(' <el-button type="primary" icon="el-icon-search" @click="handleSearch">\u641C\u7D22</el-button> '),j(C)?(u(),v(F,{key:0,type:"primary",onClick:T},{default:o(()=>[fe]),_:1})):z("v-if",!0)]),j(D)?(u(),v(K,{key:0,data:U.value,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:o(()=>[l(w,{prop:"channel_name",label:"\u6E20\u9053\u4FE1\u606F"}),l(w,{prop:"versions_b",label:"\u540E\u7AEF\u7248\u672C"}),l(w,{prop:"created_at",label:"\u521B\u5EFA\u65F6\u95F4"}),l(w,{prop:"versions_c",label:"\u524D\u7AEF\u6700\u65B0\u7248\u672C"}),l(w,{prop:"uptime",label:"\u9884\u671F\u4E0A\u7EBF\u65F6\u95F4"}),l(w,{label:"\u64CD\u4F5C"},{default:o(r=>[j(M)?(u(),v(F,{key:0,size:"small",type:"danger",onClick:ye=>N(r.row.id)},{default:o(()=>[he]),_:2},1032,["onClick"])):z("v-if",!0)]),_:1})]),_:1},8,["data"])):z("v-if",!0),h("div",Ve,[l(O,{background:"",layout:"total, prev, pager, next","current-page":t.page_index,"page-size":t.page_size,total:n.value,onCurrentChange:P},null,8,["current-page","page-size","total"])])]),l(re,{addVisible:a.value,onUpdateAdd:c},null,8,["addVisible"])])}}},xe=q(ge,[["__scopeId","data-v-c078e7e0"],["__file","/Users/apple/Desktop/project-b/relationship.b/src/views/VersionTable.vue"]]);export{xe as default};
