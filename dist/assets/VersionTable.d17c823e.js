import{_ as L,g as p,f as P,l as q,E as _,r as s,o as m,I as w,w as o,a as Y,b as a,c as x,H as T,F as z,N as G,e as V,G as R,L as S}from"./index.306d4242.js";import{i as E,j as J,k as K,l as O}from"./product.3d573cd4.js";import{h as A}from"./moment.9709ab41.js";import"./request.70c27150.js";const Q={class:"dialog-footer"},W=V("\u53D6 \u6D88"),X=V("\u786E \u5B9A"),Z={__name:"addversiontable",props:{addVisible:{default:!1}},emits:["update-add","update-addVisible"],setup(j,{emit:v}){const y=n=>n?/^([0-9]\d|[0-9])(.([0-9]\d|\d)){2}$/.test(n)?!0:(_.error("\u7248\u672C\u53F7\u683C\u5F0F\u4E3A\u6570\u5B57\u5982:x.x.x"),!1):(_.error("\u8BF7\u9009\u62E9\u6E38\u620F\uFF01"),!1),k=p([]),e=P({}),c=p([]),D=p(""),i=async()=>{if(v("update-addVisible",!1),e.add_uptime&&e.add_uptime<A().format("YYYY-MM-DD HH:mm:ss")){_.error("\u9884\u671F\u4E0A\u7EBF\u65F6\u95F4\u4E0D\u80FD\u5728\u5F53\u524D\u65F6\u95F4\u4E4B\u524D\uFF01");return}if(!y(e.add_versions_b)||!y(e.add_versions_c))return;const n={product_id:e.add_product_name_selected,channel:e.add_channel_name_selected,versions_b:e.add_versions_b,versions_c:e.add_versions_c,uptime:e.add_uptime?e.add_uptime:A().format("YYYY-MM-DD HH:mm:ss")};await J(n),_.success("\u65B0\u589E\u6210\u529F"),v("update-add")};q(()=>{C()});const C=async()=>{try{const n=await E();c.value=n.data.games,k.value=n.data.channels}catch(n){console.log(n),_.error("\u670D\u52A1\u5668\u5F02\u5E38\uFF01")}},M=()=>{v("update-add")};return(n,d)=>{const f=s("el-option"),H=s("el-select"),h=s("el-form-item"),U=s("el-input"),t=s("el-date-picker"),u=s("el-form"),b=s("el-button"),$=s("el-dialog");return m(),w($,{title:"\u65B0\u589E\u7248\u672C",width:"60%",modelValue:j.addVisible,"onUpdate:modelValue":d[5]||(d[5]=l=>G(addVisible)?addVisible.value=l:null),onClose:M},{footer:o(()=>[Y("span",Q,[a(b,{onClick:M},{default:o(()=>[W]),_:1}),a(b,{type:"primary",onClick:i},{default:o(()=>[X]),_:1})])]),default:o(()=>[a(u,{"label-width":"110px"},{default:o(()=>[a(h,{label:"\u6E38\u620F\u9009\u62E9"},{default:o(()=>[a(H,{style:{width:"18%"},modelValue:e.add_product_name_selected,"onUpdate:modelValue":d[0]||(d[0]=l=>e.add_product_name_selected=l),placeholder:"\u6E38\u620F\u9009\u62E9",class:"m-2"},{default:o(()=>[(m(!0),x(z,null,T(c.value,l=>(m(),w(f,{key:l.value,label:l.label_name,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(h,{label:"\u6E20\u9053\u9009\u62E9"},{default:o(()=>[a(H,{ref_key:"add_channel_name_selected_label",ref:D,style:{width:"18%"},modelValue:e.add_channel_name_selected,"onUpdate:modelValue":d[1]||(d[1]=l=>e.add_channel_name_selected=l),placeholder:"\u6E38\u620F\u9009\u62E9",class:"m-2"},{default:o(()=>[(m(!0),x(z,null,T(k.value,l=>(m(),w(f,{key:l.value,label:l.label_name,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(h,{label:"\u540E\u53F0\u7248\u672C"},{default:o(()=>[a(U,{style:{width:"160px"},modelValue:e.add_versions_b,"onUpdate:modelValue":d[2]||(d[2]=l=>e.add_versions_b=l)},null,8,["modelValue"])]),_:1}),a(h,{label:"\u524D\u7AEF\u7248\u672C"},{default:o(()=>[a(U,{style:{width:"160px"},modelValue:e.add_versions_c,"onUpdate:modelValue":d[3]||(d[3]=l=>e.add_versions_c=l)},null,8,["modelValue"])]),_:1}),a(h,{label:"\u9884\u671F\u4E0A\u7EBF\u65F6\u95F4",prop:"uptime"},{default:o(()=>[a(t,{modelValue:e.add_uptime,"onUpdate:modelValue":d[4]||(d[4]=l=>e.add_uptime=l),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},ee=L(Z,[["__file","/Users/apple/Desktop/project-b github/project-b/src/componentsadds/addversiontable.vue"]]);const ae={class:"crumbs"},le=V("\u98CE\u63A7\u7CFB\u7EDF"),te=V("\u7248\u672C\u7BA1\u7406"),oe={class:"container"},ne={class:"handle-box"},se=V("\xA0\xA0 "),de=V("\u65B0\u589E\u7248\u672C"),re=V("\u5220\u9664 "),ue={class:"pagination"},ce={__name:"VersionTable",setup(j){const v=p(!1),y=p([]),k=p([]),e=p(""),c=p(""),D=p([]),i=P({page_index:1,page_size:10}),C=p(0),M=()=>{f()},n=async t=>{try{const u=await K(t);u.status==200&&(k.value=await u.data.lists.map(b=>({...b,created_at:A(b.created_at).format("YYYY-MM-DD HH:mm:ss"),uptime:A(b.uptime).format("YYYY-MM-DD HH:mm:ss")})),C.value=u.data.total_count)}catch{_.error("\u670D\u52A1\u5668\u5F02\u5E38\uFF01")}v.value=!1},d=async()=>{try{const t=await E();t.status==200?(D.value=t.data.games,e.value=D.value[0].value,y.value=t.data.channels):t.message?_.error(t.message):_.error("\u540E\u7AEFapi\u63A5\u53E3\u5F02\u5E38\uFF01")}catch{_.error("\u670D\u52A1\u5668\u5F02\u5E38\uFF01")}f()},f=()=>{if(e.value==-1&&c.value==-1)n(i);else if(e.value==-1&&c.value!=-1){const t={channel:c.value,...i};n(t)}else if(e.value!=-1&&c.value==-1){const t={product_id:e.value,...i};n(t)}else if(e.value||c.value){const t={product_id:e.value,channel:c.value,...i};n(t)}else n(i)},H=async t=>{try{await S.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F","\u63D0\u793A",{type:"warning"}),await O(t),_.success("\u5220\u9664\u7248\u672C\u6210\u529F"),await n()}catch{_.error("\u8BF7\u91CD\u8BD5")}},h=t=>{i.page_index=t,f()},U=()=>{v.value=!0};return n(),d(),(t,u)=>{const b=s("el-breadcrumb-item"),$=s("el-breadcrumb"),l=s("el-option"),B=s("el-select"),N=s("el-button"),g=s("el-table-column"),F=s("el-table"),I=s("el-pagination");return m(),x("div",null,[Y("div",ae,[a($,{separator:"/"},{default:o(()=>[a(b,null,{default:o(()=>[le]),_:1}),a(b,null,{default:o(()=>[te]),_:1})]),_:1})]),Y("div",oe,[Y("div",ne,[a(B,{modelValue:e.value,"onUpdate:modelValue":u[0]||(u[0]=r=>e.value=r),placeholder:"\u6E38\u620F\u9009\u62E9",class:"m-2",onChange:M},{default:o(()=>[(m(!0),x(z,null,T(D.value,r=>(m(),w(l,{key:r.value,label:r.label_name,value:r.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(B,{modelValue:c.value,"onUpdate:modelValue":u[1]||(u[1]=r=>c.value=r),placeholder:"\u6E20\u9053\u9009\u62E9",class:"m-2",onChange:f},{default:o(()=>[a(l,{label:"\u5168\u90E8",value:"-1"}),(m(!0),x(z,null,T(y.value,r=>(m(),w(l,{key:r.value,label:r.label_name,value:r.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),se,R(' <el-button type="primary" icon="el-icon-search" @click="handleSearch">\u641C\u7D22</el-button> '),a(N,{type:"primary",onClick:U},{default:o(()=>[de]),_:1})]),a(F,{data:k.value,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:o(()=>[a(g,{prop:"channel_name",label:"\u6E20\u9053\u4FE1\u606F"}),a(g,{prop:"versions_b",label:"\u540E\u7AEF\u7248\u672C"}),a(g,{prop:"created_at",label:"\u521B\u5EFA\u65F6\u95F4"}),a(g,{prop:"versions_c",label:"\u524D\u7AEF\u6700\u65B0\u7248\u672C"}),a(g,{prop:"uptime",label:"\u9884\u671F\u4E0A\u7EBF\u65F6\u95F4"}),a(g,{label:"\u64CD\u4F5C"},{default:o(r=>[a(N,{size:"small",type:"danger",onClick:_e=>H(r.row.id)},{default:o(()=>[re]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Y("div",ue,[a(I,{background:"",layout:"total, prev, pager, next","current-page":i.page_index,"page-size":i.page_size,total:C.value,onCurrentChange:h},null,8,["current-page","page-size","total"])])]),a(ee,{addVisible:v.value,onUpdateAdd:n},null,8,["addVisible"])])}}},ve=L(ce,[["__scopeId","data-v-c078e7e0"],["__file","/Users/apple/Desktop/project-b github/project-b/src/views/VersionTable.vue"]]);export{ve as default};
