import{_ as F,g as i,f as N,by as j,u as G,o as b,c as Y,a as w,b as a,w as p,bw as B,r as g,U as A,aJ as H,a4 as I,e as v}from"./index.06cbec42.js";import{a as K,b as Q}from"./product.2a668420.js";import{h as E}from"./moment.9709ab41.js";import{l as R}from"./user.9ae7a840.js";import{e as X}from"./export2excel.a0c92898.js";import"./request.ab0faebb.js";const u=i(""),m=i(""),S=i([]),z=i([]);let k=i("");const Z=i("\u9879\u76EE"),C=N({}),x=i({}),f=i(0),l=N({page_index:1,page_size:10,status:3});let T=i([]),U=i([]),q=i([]);const $=i(),P=i(!1),_=e=>{R(e).then(d=>{var h;S.value=(h=d.data)==null?void 0:h.lists.map(t=>({...t,updated_at:E(t.updated_at).format("YYYY-MM-DD HH:mm:ss")})),f.value=d.data.total_count,C.apply_users_count=d.data.apply_users_count,C.unaudit_orders_count=d.data.unaudit_orders_count,C.unaudit_reward_sum=d.data.unaudit_reward_sum,x.value=JSON.parse(JSON.stringify(e))}).catch(d=>{}).then(()=>{})},aa=()=>{K().then(e=>{T.value=e.data,q.value=e.data}).catch(()=>{})},y=e=>{Q({main_product_id:e}).then(h=>{U.value=h.data}).catch(()=>{})},ea={name:"basetable",setup(){u.value="",m.value="";const e=j(),d=G();e.params.product_name!==""?(u.value=e.params.main_product_name,m.value=e.params.product_name,l.product_id=e.params.product_id,k.value=e.params.main_product_id,y(e.params.main_product_id)):e.params.main_product_name!==""?(u.value=e.params.main_product_name,l.main_product_id=e.params.main_product_id,k.value=e.params.main_product_id,y(e.params.main_product_id)):y(),console.log(u.value,m.value);const h=()=>{d.go(-1)};return _(l),aa(),{tableData:S,widthdrawDetail:C,product_type:Z,options:T,suboptions:U,addoptions:q,main_product_name_selected:u,product_name_selected:m,getProductAndDataList:()=>{if(m.value="",u.value==-1)_(l);else{const o={...l,main_product_id:u.value};l.product_id="",k.value=u.value,_(o),y(u.value)}},getDataById:()=>{if(m.value==-1){const o={...l,product_id:u.value};o.product_id==-1&&delete o.product_id,_(o)}else{const o={...l,product_id:m.value};l.product_id=m.value,o.product_id==-1&&delete o.product_id,_(o)}},query:l,handlePageChange:o=>{if(l.page_index=o,u.value==-1)_(l);else if(u.value>0)if(m.value==-1){const n={main_product_id:u.value,...l};_(n)}else if(m.value>0){const n={...l,product_id:m.value};_(n)}else{const n={...l,main_product_id:u.value};_(n)}else{const n={...l};_(n)}},pageTotal:f,handleDate:o=>{if(o!==null){let n=[];o.forEach(s=>{s!=null&&n.push(E(s).format("YYYY-MM-DD HH:mm:ss"))});let r={...l,start_date:n[0],end_date:n[1]};l.start_date=n[0],l.end_date=n[1],_(r)}else _(l)},dateRange:$,getExcel:()=>{console.log("dataExport.value",x.value),x.value.page_size=f.value?f.value<=1e4?f.value:1e4:10,R(x.value).then(o=>{if(o.status==200){z.value=o.data.lists.map(r=>({wechat_user_id:r.wechat_user_id,main_product_name:r.main_product_name,product_name:r.product_name,nickname:r.nickname,bind_account_count:r.bind_account_count,amount:r.amount,oaid:r.oaid,ip:r.ip,ip_address:r.ip_address,updated_at:E(r.updated_at).format("YYYY-MM-DD HH:mm:ss")}));const n=["\u7528\u6237ID","\u9879\u76EE\u540D\u79F0","\u5E94\u7528\u540D\u79F0","\u7528\u6237\u540D","\u8BBE\u5907\u5173\u8054\u8D26\u53F7","\u7533\u8BF7\u63D0\u73B0\u91D1\u989D","\u6570\u76DFid","ip","ip\u5730\u5740","\u63D0\u73B0\u65F6\u95F4"];X(z.value,"\u63D0\u73B0\u8BB0\u5F55",n,"\u63D0\u73B0\u8BB0\u5F55")}else o.message?B.error(o.message):B.error("\u540E\u7AEFapi\u63A5\u53E3\u5F02\u5E38\uFF01")})},isShow:P,get:()=>{P.value=!P.value,l.status=3,_(l)},goback:h,main_product_id:k}},methods:{withdrawDetail(e){this.$router.push({name:"userdetail",params:{wechat_user_id:e}})}}},ta={class:"crumbs"},oa=v("\u98CE\u63A7\u7CFB\u7EDF"),la=v("\u7528\u6237\u7BA1\u7406"),na=v("\u63D0\u73B0\u8BB0\u5F55"),da={class:"container"},ra={class:"handle-box"},ca=v("\u5BFC\u51FA"),sa=v("\u8FD4\u56DE"),ua=v("\u8BE6\u60C5 "),_a={class:"pagination"};function ia(e,d,h,t,J,L){const D=g("el-breadcrumb-item"),M=g("el-breadcrumb"),V=g("el-option"),o=g("el-select"),n=g("el-date-picker"),r=g("el-button"),s=g("el-table-column"),O=g("el-table"),W=g("el-pagination");return b(),Y("div",null,[w("div",ta,[a(M,{separator:"/"},{default:p(()=>[a(D,null,{default:p(()=>[oa]),_:1}),a(D,null,{default:p(()=>[la]),_:1}),a(D,null,{default:p(()=>[na]),_:1})]),_:1})]),w("div",da,[w("div",ra,[a(o,{modelValue:t.main_product_name_selected,"onUpdate:modelValue":d[0]||(d[0]=c=>t.main_product_name_selected=c),placeholder:"\u9879\u76EE",class:"m-2",onChange:t.getProductAndDataList},{default:p(()=>[(b(!0),Y(A,null,H(t.options,c=>(b(),I(V,{key:c.id,label:c.main_product_name,value:c.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),a(o,{modelValue:t.product_name_selected,"onUpdate:modelValue":d[1]||(d[1]=c=>t.product_name_selected=c),placeholder:"\u5E94\u7528",class:"m-2",onChange:t.getDataById},{default:p(()=>[(b(!0),Y(A,null,H(t.suboptions,c=>(b(),I(V,{key:c.product_id,label:c.product_name,value:c.product_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),a(n,{modelValue:t.dateRange,"onUpdate:modelValue":d[2]||(d[2]=c=>t.dateRange=c),type:"daterange","range-separator":"\u2192",onChange:t.handleDate,"start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F"},null,8,["modelValue","onChange"]),a(r,{type:"primary",onClick:t.getExcel},{default:p(()=>[ca]),_:1},8,["onClick"]),a(r,{type:"primary",onClick:t.goback},{default:p(()=>[sa]),_:1},8,["onClick"])]),a(O,{data:t.tableData,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:p(()=>[a(s,{prop:"wechat_user_id",label:"\u7528\u6237ID"}),a(s,{prop:"main_product_name",label:"\u9879\u76EE\u540D\u79F0"}),a(s,{prop:"product_name",label:"\u5E94\u7528\u540D\u79F0"}),a(s,{prop:"nickname",label:"\u7528\u6237\u540D"}),a(s,{prop:"bind_account_count",label:"\u8BBE\u5907\u5173\u8054\u8D26\u53F7"}),a(s,{prop:"amount",label:"\u7533\u8BF7\u63D0\u73B0\u91D1\u989D"}),a(s,{prop:"oaid",label:"\u6570\u76DFid"}),a(s,{prop:"ip",label:"ip"}),a(s,{prop:"ip_address",label:"ip\u5730\u5740"}),a(s,{prop:"updated_at",sortable:"",label:"\u63D0\u73B0\u65F6\u95F4"}),a(s,{label:"\u64CD\u4F5C",width:"220",align:"center"},{default:p(c=>[a(r,{type:"text",icon:"el-icon-link",onClick:pa=>L.withdrawDetail(c.row.wechat_user_id)},{default:p(()=>[ua]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),w("div",_a,[a(W,{background:"",layout:"total, prev, pager, next","current-page":t.query.page_index,"page-size":t.query.page_size,total:t.pageTotal,onCurrentChange:t.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])])])}const Da=F(ea,[["render",ia],["__scopeId","data-v-04d12d46"]]);export{Da as default};
