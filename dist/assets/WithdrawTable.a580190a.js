import{_ as Pt,u as At,r as i,D as S,C as Tt,w as Bt,e as _,g as Lt,a as h,c as $,t as U,j as e,k as l,h as y,y as p,q as j,U as M,p as k,z as n,T as St,b as $t,F as O,m as G,v as rt,A as jt,B as Et,l as x}from"./index.3fee5d13.js";import{w as Nt,i as Rt,j as Wt}from"./user.18d2d274.js";import{s as E}from"./showButton.83421764.js";const Ft=T=>(jt("data-v-fb7e65cc"),T=T(),Et(),T),qt={class:"crumbs"},Mt=n("\u98CE\u63A7\u7CFB\u7EDF"),Ot=n("\u63D0\u73B0\u914D\u7F6E"),Gt={class:"container"},Ht={class:"handle-box"},Jt=Ft(()=>U("span",null," \u9009\u62E9\u5E94\u7528 ",-1)),Kt=n("\xA0\xA0 "),Qt=n(" \u9ED8\u8BA4\u89C4\u5219"),Xt=n("\u63D0\u73B0\u8BBE\u7F6E"),Yt=n("\u4EBA\u5DE5\u5BA1\u6838\u8BB0\u5F55"),Zt=n("\u67E5\u8BE2"),ta=n("\u91CD\u7F6E"),aa=n("\u4EBA\u5DE5\u5BA1\u6838 "),ea=n("\u63D0\u73B0\u8BBE\u7F6E "),la={class:"pagination"},oa={class:"dialog-footer"},da=n("\u53D6 \u6D88"),sa=n("\u786E \u5B9A"),ua=n("\u6240\u6709\u9879\u76EE"),ra=n("\u6307\u5B9A\u9879\u76EE"),ia={class:"dialog-footer"},na=n("\u53D6 \u6D88"),_a=n("\u786E \u5B9A"),pa={__name:"WithdrawTable",setup(T){const it=E("service:withdraw:view"),nt=E("service:withdraw:review"),H=E("service:withdraw:config"),_t=E("service:withdraw:default"),J=At(),I=i(!0),w=i(""),b=i(""),v=S({page_index:1,page_size:10}),K=i(0);i(""),i("");const r=S({}),d=S({}),N=i(null),Q=i(!1),R=i(!1),X=i([]);i(""),i("\u9879\u76EE");let Y=i([]),C=i([]),pt=i([]);i();const V=(o,t)=>{I.value=!0,Nt(o).then(s=>{s.status==200?(I.value=!1,X.value=s.data.lists.filter(m=>m.config_type!=0).map(m=>({...m,biomass_login_status:m.biomass_login_status==1?"\u5141\u8BB8":"\u7981\u6B62",user_withdrawal_status:m.user_withdrawal_status==1?"\u5141\u8BB8":"\u7981\u6B62"})),K.value=t==1?s.data.total_count:s.data.total_count-1,r.value=s.data.lists.filter(m=>m.config_type==0)[0],r.value.config_type==0&&(Q.value=!0,r.user_withdrawal_status=r.value.user_withdrawal_status==1,r.biomass_login_status=r.value.biomass_login_status==1,r.withdrawal_audit_standard=r.value.withdrawal_audit_standard,r.withdrawal_count=r.value.withdrawal_count),I.value=!1):(I.value=!1,x.error(s==null?void 0:s.message))}).catch(()=>{})},wt=()=>{et.push({name:"withdrawreview"})},ct=()=>{St().then(o=>{Y.value=o.data,pt.value=o.data,w.value=o.data[0].id;let t={...v,main_product_id:o.data[0].id};V(t)}).catch(()=>{})},W=o=>{$t({main_product_id:o}).then(s=>{C.value=s.data}).catch(()=>{})},mt=()=>{d.biomass_login_status=!1,d.config_type="",d.user_withdrawal_status=!1,d.withdrawal_audit_standard="",d.withdrawal_count=""},Z=o=>{Rt(o).then(t=>{t.status==200?(x.success("\u6DFB\u52A0\u63D0\u73B0\u914D\u7F6E\u6210\u529F"),mt(),V(v)):t.status==""&&x.error("\u6B64\u6E38\u620F\u914D\u7F6E\u5DF2\u5B58\u5728\uFF01")})},ft=(o,t)=>{Wt(o,t).then(s=>{s.status==200&&(x.success("\u4FEE\u6539\u63D0\u73B0\u914D\u7F6E\u6210\u529F"),V(v))})},tt=o=>o?/^\d+(\.{0,1}\d+){0,1}$/.test(o)?!0:(x.error("\u8BF7\u5148\u9009\u62E9\u4EA7\u54C1\uFF01"),!1):(x.error("\u8BF7\u9009\u62E9\u6E38\u620F\uFF01"),!1),B=o=>{if(o)return/^\d+(\.{0,1}\d+){0,1}$/.test(o)?!0:(x.error("\u8BF7\u8F93\u5165\u6570\u5B57\uFF01"),!1)};w.value="",b.value="";const at={};ct();const et=Tt(),ht=(o,t,s,m)=>{et.push({name:"withdrawdetail",params:{main_product_name:o,main_product_id:t,product_id:m,product_name:s}})};let u=S({id:"",main_product_id:"",product_id:"",main_product_name:"",product_name:"",user_withdrawal_status:"",biomass_login_status:"",withdrawal_audit_standard:"",withdrawal_count:""});const P=i(!1),A=i(!1),bt=(o,t)=>{Object.keys(u).forEach(s=>{s=="user_withdrawal_status"||s=="biomass_login_status"?u[s]=t[s]=="\u5141\u8BB8":u[s]=t[s]}),P.value=!0},vt=()=>{A.value=!0},gt=o=>{v.page_index=o,lt()},Vt=()=>{if(P.value=!1,u.withdrawal_audit_standard&&!B(u.withdrawal_audit_standard)||u.withdrawal_count&&!B(u.withdrawal_count))return;const o={user_withdrawal_status:u.user_withdrawal_status?1:0,biomass_login_status:u.biomass_login_status?1:0,withdrawal_audit_standard:u.withdrawal_audit_standard,withdrawal_count:u.withdrawal_count};ft(u.id,o)},yt=()=>{if(A.value=!1,!(d.withdrawal_audit_standard&&!B(d.withdrawal_audit_standard))&&!(d.withdrawal_count&&!B(d.withdrawal_count)))if(d.config_type)if(d.config_type==1){if(!tt(w.value))return;b.value.forEach(function(o){if(!tt(o))return;const t=C.value.filter(m=>m.product_id==o),s={config_type:1,main_product_id:t[0].main_product_id,main_product_name:t[0].main_product_name,product_id:t[0].product_id,product_name:t[0].product_name,user_withdrawal_status:d.user_withdrawal_status?1:0,biomass_login_status:d.biomass_login_status?1:0,withdrawal_audit_standard:d.withdrawal_audit_standard,withdrawal_count:d.withdrawal_count};Z(s)}),w.value="",b.value="",C.value=""}else{const o={config_type:0,user_withdrawal_status:d.user_withdrawal_status?1:0,biomass_login_status:d.biomass_login_status?1:0,withdrawal_audit_standard:d.withdrawal_audit_standard,withdrawal_count:d.withdrawal_count};Z(o)}else{x.error("\u5FC5\u987B\u9009\u62E9\u914D\u7F6E\u7C7B\u578B\uFF01");return}},lt=()=>{if(console.log(w.value),b.value="",C.value="",w.value==""||!w.value)console.log("1"),V(v);else{const o={main_product_id:w.value,...v};V(o,1),W(w.value)}},ot=()=>{if(w.value==""||!w.value)V(v);else if(b.value==""){const o={main_product_id:w.value,...v};V(o,1)}else{const o={product_id:b.value,...v};V(o,1)}},kt=()=>{b.value="",ot()};return Bt(()=>J.mainProductId,(o,t)=>{console.log(o),w.value=o,W(o)}),W(J.mainProductId),(o,t)=>{const s=_("el-breadcrumb-item"),m=_("el-breadcrumb"),L=_("el-option"),F=_("el-select"),g=_("el-button"),D=_("el-switch"),c=_("el-form-item"),z=_("el-input"),q=_("el-form"),xt=_("el-drawer"),f=_("el-table-column"),dt=_("el-tag"),Ut=_("el-table"),Ct=_("el-pagination"),st=_("el-dialog"),ut=_("el-radio"),Dt=_("el-radio-group"),zt=Lt("loading");return h(),$("div",null,[U("div",qt,[e(m,{separator:"/"},{default:l(()=>[e(s,null,{default:l(()=>[Mt]),_:1}),e(s,null,{default:l(()=>[Ot]),_:1})]),_:1})]),U("div",Gt,[U("div",Ht,[y("v-if",!0),Jt,e(F,{style:{width:"200px"},modelValue:b.value,"onUpdate:modelValue":t[1]||(t[1]=a=>b.value=a),placeholder:"\u5E94\u7528\u540D\u79F0",class:"m-2"},{default:l(()=>[e(L,{label:"\u5168\u90E8",value:""}),(h(!0),$(O,null,G(p(C),a=>(h(),k(L,{key:a.product_id,label:a.product_name,value:a.product_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),Kt,p(_t)?j((h(),k(g,{key:1,type:"primary",onClick:t[2]||(t[2]=a=>R.value=!0)},{default:l(()=>[Qt]),_:1},512)),[[M,Q.value]]):y("v-if",!0),p(H)?(h(),k(g,{key:2,type:"primary",onClick:vt},{default:l(()=>[Xt]),_:1})):y("v-if",!0),p(nt)?(h(),k(g,{key:3,type:"primary",onClick:wt},{default:l(()=>[Yt]),_:1})):y("v-if",!0),e(g,{type:"primary",onClick:ot},{default:l(()=>[Zt]),_:1}),e(g,{type:"info",onClick:kt},{default:l(()=>[ta]),_:1}),e(xt,{modelValue:R.value,"onUpdate:modelValue":t[7]||(t[7]=a=>R.value=a),title:"\u63D0\u73B0\u9ED8\u8BA4\u89C4\u5219\u4FE1\u606F\uFF1A",direction:"rtl",size:"50%"},{default:l(()=>[e(q,{ref_key:"formRef",ref:N,model:r,"label-width":"280px"},{default:l(()=>[e(c,{label:"\u662F\u5426\u5141\u8BB8\u6240\u6709\u7528\u6237\u63D0\u73B0",prop:"user_withdrawal_status"},{default:l(()=>[e(D,{disabled:"",modelValue:r.user_withdrawal_status,"onUpdate:modelValue":t[3]||(t[3]=a=>r.user_withdrawal_status=a)},null,8,["modelValue"])]),_:1}),e(c,{label:"\u662F\u5426\u5141\u8BB8\u81EA\u7136\u91CF\u767B\u5F55",prop:"biomass_login_status"},{default:l(()=>[e(D,{disabled:"",modelValue:r.biomass_login_status,"onUpdate:modelValue":t[4]||(t[4]=a=>r.biomass_login_status=a)},null,8,["modelValue"])]),_:1}),e(c,{label:"\u63D0\u73B0\u5BA1\u6838\u6807\u51C6",prop:"withdrawal_audit_standard"},{default:l(()=>[e(z,{disabled:"",style:{width:"150px"},modelValue:r.withdrawal_audit_standard,"onUpdate:modelValue":t[5]||(t[5]=a=>r.withdrawal_audit_standard=a)},null,8,["modelValue"])]),_:1}),e(c,{label:"\u5355\u65E5\u63D0\u73B0\u6B21\u6570",prop:"withdrawal_count"},{default:l(()=>[e(z,{disabled:"",style:{width:"150px"},modelValue:r.withdrawal_count,"onUpdate:modelValue":t[6]||(t[6]=a=>r.withdrawal_count=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]),p(it)?j((h(),k(Ut,{key:0,data:X.value,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:l(()=>[e(f,{prop:"main_product_id",label:"\u9879\u76EEID"}),e(f,{prop:"main_product_name",label:"\u9879\u76EE\u540D\u79F0"}),e(f,{prop:"product_id",label:"\u5E94\u7528ID"}),e(f,{prop:"product_name",label:"\u5E94\u7528\u540D\u79F0"}),e(f,{prop:"unaudit_orders_count",label:"\u672A\u5BA1\u6838\u8BA2\u5355\u6570"}),e(f,{prop:"unaudit_reward_sum",label:"\u672A\u5BA1\u6838\u603B\u91D1\u989D"}),e(f,{prop:"apply_users_count",label:"\u7533\u8BF7\u4EBA\u6570"}),e(f,{prop:"user_withdrawal_status",label:"\u7528\u6237\u63D0\u73B0"},{default:l(a=>[e(dt,{type:a.row.user_withdrawal_status==="\u5141\u8BB8"?"":a.row.user_withdrawal_status==="\u7981\u6B62"?"danger":""},{default:l(()=>[n(rt(a.row.user_withdrawal_status),1)]),_:2},1032,["type"])]),_:1}),e(f,{prop:"biomass_login_status",label:"\u81EA\u7136\u91CF\u767B\u5F55"},{default:l(a=>[e(dt,{type:a.row.biomass_login_status==="\u5141\u8BB8"?"":a.row.biomass_login_status==="\u7981\u6B62"?"danger":""},{default:l(()=>[n(rt(a.row.biomass_login_status),1)]),_:2},1032,["type"])]),_:1}),e(f,{prop:"withdrawal_audit_standard",label:"\u63D0\u73B0\u5BA1\u6838\u6807\u51C6"}),e(f,{prop:"withdrawal_count",label:"\u5355\u7528\u6237\u5F53\u5929\u63D0\u73B0\u6B21\u6570"}),e(f,{label:"\u64CD\u4F5C",width:"220",align:"center"},{default:l(a=>[e(g,{type:"text",icon:"el-icon-link",onClick:It=>ht(a.row.main_product_name,a.row.main_product_id,a.row.product_name,a.row.product_id)},{default:l(()=>[aa]),_:2},1032,["onClick"]),p(H)?(h(),k(g,{key:0,type:"text",icon:"el-icon-edit",onClick:It=>bt(a.row.id,a.row)},{default:l(()=>[ea]),_:2},1032,["onClick"])):y("v-if",!0)]),_:1})]),_:1},8,["data"])),[[zt,I.value]]):y("v-if",!0),U("div",la,[e(Ct,{background:"",layout:"total, prev, pager, next","current-page":v.page_index,"page-size":v.page_size,total:K.value,onCurrentChange:gt},null,8,["current-page","page-size","total"])])]),y(" \u7F16\u8F91\u5F39\u51FA\u6846 "),e(st,{title:"\u7F16\u8F91\u63D0\u73B0\u914D\u7F6E",modelValue:P.value,"onUpdate:modelValue":t[13]||(t[13]=a=>P.value=a),width:"60%"},{footer:l(()=>[U("span",oa,[e(g,{onClick:t[12]||(t[12]=a=>P.value=!1)},{default:l(()=>[da]),_:1}),e(g,{type:"primary",onClick:Vt},{default:l(()=>[sa]),_:1})])]),default:l(()=>[e(q,{ref_key:"formRef",ref:N,rules:at,model:p(u),"label-width":"280px"},{default:l(()=>[e(c,{label:"\u662F\u5426\u5141\u8BB8\u6240\u6709\u7528\u6237\u63D0\u73B0",prop:"user_withdrawal_status"},{default:l(()=>[e(D,{modelValue:p(u).user_withdrawal_status,"onUpdate:modelValue":t[8]||(t[8]=a=>p(u).user_withdrawal_status=a)},null,8,["modelValue"])]),_:1}),e(c,{label:"\u662F\u5426\u5141\u8BB8\u81EA\u7136\u91CF\u767B\u5F55",prop:"biomass_login_status"},{default:l(()=>[e(D,{modelValue:p(u).biomass_login_status,"onUpdate:modelValue":t[9]||(t[9]=a=>p(u).biomass_login_status=a)},null,8,["modelValue"])]),_:1}),e(c,{label:"\u63D0\u73B0\u5BA1\u6838\u6807\u51C6",prop:"withdrawal_audit_standard"},{default:l(()=>[e(z,{style:{width:"150px"},modelValue:p(u).withdrawal_audit_standard,"onUpdate:modelValue":t[10]||(t[10]=a=>p(u).withdrawal_audit_standard=a)},null,8,["modelValue"])]),_:1}),e(c,{label:"\u5355\u65E5\u63D0\u73B0\u6B21\u6570",prop:"withdrawal_count"},{default:l(()=>[e(z,{style:{width:"150px"},modelValue:p(u).withdrawal_count,"onUpdate:modelValue":t[11]||(t[11]=a=>p(u).withdrawal_count=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),y(" \u65B0\u589E\u5F39\u51FA\u6846 "),e(st,{title:"\u65B0\u589E\u63D0\u73B0\u914D\u7F6E",modelValue:A.value,"onUpdate:modelValue":t[22]||(t[22]=a=>A.value=a),width:"60%"},{footer:l(()=>[U("span",ia,[e(g,{onClick:t[21]||(t[21]=a=>A.value=!1)},{default:l(()=>[na]),_:1}),e(g,{type:"primary",onClick:yt},{default:l(()=>[_a]),_:1})])]),default:l(()=>[e(q,{ref_key:"formRef",ref:N,rules:at,model:d,"label-width":"280px"},{default:l(()=>[e(c,{label:"\u914D\u7F6E\u7C7B\u578B",prop:"config_type"},{default:l(()=>[e(Dt,{modelValue:d.config_type,"onUpdate:modelValue":t[14]||(t[14]=a=>d.config_type=a)},{default:l(()=>[e(ut,{label:"0"},{default:l(()=>[ua]),_:1}),e(ut,{label:"1"},{default:l(()=>[ra]),_:1})]),_:1},8,["modelValue"])]),_:1}),j(e(c,{label:"\u9879\u76EE",prop:"main_product_name_selected"},{default:l(()=>[e(F,{style:{width:"200px"},modelValue:w.value,"onUpdate:modelValue":t[15]||(t[15]=a=>w.value=a),placeholder:"\u9879\u76EE",class:"m-2",onChange:lt},{default:l(()=>[(h(!0),$(O,null,G(p(Y),a=>(h(),k(L,{key:a.id,label:a.main_product_name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},512),[[M,d.config_type==1]]),j(e(c,{label:"\u5E94\u7528",prop:"product_name_selected"},{default:l(()=>[e(F,{style:{width:"200px"},multiple:"",modelValue:b.value,"onUpdate:modelValue":t[16]||(t[16]=a=>b.value=a),placeholder:"\u5E94\u7528",class:"m-2"},{default:l(()=>[(h(!0),$(O,null,G(p(C),a=>(h(),k(L,{key:a.product_id,label:a.product_name,value:a.product_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},512),[[M,d.config_type==1]]),e(c,{label:"\u662F\u5426\u5141\u8BB8\u6240\u6709\u7528\u6237\u63D0\u73B0",prop:"user_withdrawal_status"},{default:l(()=>[e(D,{modelValue:d.user_withdrawal_status,"onUpdate:modelValue":t[17]||(t[17]=a=>d.user_withdrawal_status=a)},null,8,["modelValue"])]),_:1}),e(c,{label:"\u662F\u5426\u5141\u8BB8\u81EA\u7136\u91CF\u767B\u5F55",prop:"biomass_login_status"},{default:l(()=>[e(D,{modelValue:d.biomass_login_status,"onUpdate:modelValue":t[18]||(t[18]=a=>d.biomass_login_status=a)},null,8,["modelValue"])]),_:1}),e(c,{label:"\u63D0\u73B0\u5BA1\u6838\u6807\u51C6",prop:"withdrawal_audit_standard"},{default:l(()=>[e(z,{style:{width:"150px"},modelValue:d.withdrawal_audit_standard,"onUpdate:modelValue":t[19]||(t[19]=a=>d.withdrawal_audit_standard=a)},null,8,["modelValue"])]),_:1}),e(c,{label:"\u5355\u65E5\u63D0\u73B0\u6B21\u6570",prop:"withdrawal_count"},{default:l(()=>[e(z,{style:{width:"150px"},modelValue:d.withdrawal_count,"onUpdate:modelValue":t[20]||(t[20]=a=>d.withdrawal_count=a)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},fa=Pt(pa,[["__scopeId","data-v-fb7e65cc"],["__file","/Users/apple/Desktop/project-b/relationship.b/src/views/WithdrawTable.vue"]]);export{fa as default};
