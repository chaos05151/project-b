import{_ as $,g as s,f as J,by as aa,u as ea,o as w,c as V,a as k,b as e,w as c,bx as E,r as m,U as S,aJ as T,a4 as U,e as b,t as Y,b6 as A,bq as O,bw as W}from"./index.3430d699.js";import{a as ta,b as oa}from"./product.c1757ced.js";import{h as R}from"./moment.9709ab41.js";import{l as j,m as na}from"./user.1e5e51b7.js";import"./request.79f6b612.js";const _=s(""),f=s(""),G=s([]),K=s(),da=s("\u4E00\u7EA7\u6E38\u620F"),y=J({}),Q=s(0),l=J({product_id:"",page_index:1,page_size:10,status:1});let v=s(""),M=s([]),B=s([]),X=s([]);const P=s(),la=s(!1),h=t=>{j(t).then(d=>{var u;return G.value=(u=d.data)==null?void 0:u.lists.map(a=>({...a,updated_at:R(a.updated_at).format("YYYY-MM-DD HH:mm:ss")})),Q.value=d.data.total_count,y.apply_users_count=d.data.apply_users_count,y.unaudit_orders_count=d.data.unaudit_orders_count,y.unaudit_reward_sum=d.data.unaudit_reward_sum,t={...t,page_size:d.data.total_count},t}).catch(()=>{})},ra=t=>{j(t).then(d=>{var u;K.value=(u=d.data)==null?void 0:u.lists.map(a=>({...{wechat_user_id:a.wechat_user_id,main_product_name:a.main_product_name,product_name:a.product_name,nickname:a.nickname,bind_account_count:a.bind_account_count,amount:a.amount,oaid:a.oaid,ip:a.ip,ip_address:a.ip_address,updated_at:a.updated_at},updated_at:R(a.updated_at).format("YYYY-MM-DD HH:mm:ss")}))}).catch(()=>{})},ca=()=>{ta().then(t=>{M.value=t.data,X.value=t.data}).catch(()=>{})},L=t=>{oa({main_product_id:t}).then(u=>{B.value=u.data}).catch(()=>{})},F=(t,d)=>{na({id:t,status:d}).then(a=>{a.status==200?(W.success("\u5BA1\u6838\u6210\u529F\uFF01"),h(l)):W.error(a.message)}).catch(()=>{})},_a={name:"basetable",setup(){f.value="",typeof _.value=="number"&&(v.value=_.value),_.value="";const t=aa();t.params.product_name!==""?(_.value=t.params.main_product_name,f.value=t.params.product_name,l.product_id=t.params.product_id,v.value=t.params.main_product_id,L(t.params.main_product_id)):(delete l.product_id,t.params.main_product_name!==""&&(_.value=t.params.main_product_name,v.value=t.params.main_product_id,L(t.params.main_product_id))),l.status=1,h(l),ca();const d=n=>{if(n!==null){let o=[];n.forEach(i=>{i!=null&&o.push(R(i).format("YYYY-MM-DD HH:mm:ss"))});let g={...l,start_date:o[0],end_date:o[1]};l.start_date=o[0],l.end_date=o[1],h(g)}else h(l)},u=ea();return{tableData:G,widthdrawDetail:y,handleDelete:n=>{E.confirm("\u786E\u5B9A\u8981\u62D2\u7EDD\u5417\uFF1F","\u63D0\u793A",{type:"warning"}).then(()=>{F(n,4)}).catch(()=>{})},handleOk:n=>{E.confirm("\u786E\u5B9A\u8981\u540C\u610F\u5417\uFF1F","\u63D0\u793A",{type:"warning"}).then(()=>{F(n,2)}).catch(()=>{})},product_type:da,options:M,suboptions:B,addoptions:X,main_product_name_selected:_,product_name_selected:f,getProductAndDataList:()=>{f.value="",_.value==-1||({...l,main_product_id:_.value},l.product_id="",v.value=_.value,L(_.value))},getDataById:()=>{if(f.value==-1){const n={...l,product_id:_.value};n.product_id==-1&&delete n.product_id,h(n)}else{const n={...l,product_id:f.value};l.product_id=f.value,n.product_id==-1&&delete n.product_id,h(n)}},query:l,handlePageChange:n=>{if(l.page_index=n,_.value==-1)h(l);else if(_.value>0)if(f.value==-1){const o={product:_.value,...l};h(o)}else if(f.value>0){const o={...l,product_id:f.value};h(o)}else{const o={...l,product_id:_.value};h(o)}else{const o={...l};h(o)}},pageTotal:Q,handleDate:d,dateRange:P,isShow:la,withDrawRecord:(n,o,g)=>{typeof o=="number"?B.value.map(i=>{if(i.product_id==o){n=i.main_product_name,o=i.product_name;return}}):typeof n=="number"&&o==""&&M.value.map(i=>{i.id==n&&(n=i.main_product_name)}),P.value=null,u.push({name:"withdrawdetailall",params:{main_product_name:n,product_name:o,product_id:g,main_product_id:v.value}})},ExcelData:K,main_product_id:v,getExcelData:ra,goback:()=>{P.value=null,u.push({name:"withdraw"})}}},methods:{withdrawDetail(t){this.$router.push({name:"userdetail",params:{wechat_user_id:t}})}}},ua={class:"crumbs"},sa=b("\u98CE\u63A7\u7CFB\u7EDF"),ia=b("\u7528\u6237\u7BA1\u7406"),pa=b("\u7533\u8BF7\u63D0\u73B0\u5217\u8868"),ma={class:"container"},ha={class:"handle-box"},ba=b("\u7528\u6237\u63D0\u73B0\u8BB0\u5F55"),fa=b("\u8FD4\u56DE"),ga=b("\u8BE6\u60C5 "),va=b("\u540C\u610F "),wa=b("\u62D2\u7EDD "),Da={class:"pagination"};function ka(t,d,u,a,H,q){const D=m("el-breadcrumb-item"),z=m("el-breadcrumb"),C=m("el-option"),x=m("el-select"),n=m("el-date-picker"),o=m("el-button"),g=m("el-form-item"),i=m("el-form"),p=m("el-table-column"),Z=m("el-table"),N=m("el-pagination");return w(),V("div",null,[k("div",ua,[e(z,{separator:"/"},{default:c(()=>[e(D,null,{default:c(()=>[sa]),_:1}),e(D,null,{default:c(()=>[ia]),_:1}),e(D,null,{default:c(()=>[pa]),_:1})]),_:1})]),k("div",ma,[k("div",ha,[e(x,{modelValue:a.main_product_name_selected,"onUpdate:modelValue":d[0]||(d[0]=r=>a.main_product_name_selected=r),placeholder:"\u4E00\u7EA7\u6E38\u620F",class:"m-2",onChange:a.getProductAndDataList},{default:c(()=>[(w(!0),V(S,null,T(a.options,r=>(w(),U(C,{key:r.id,label:r.main_product_name,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),e(x,{modelValue:a.product_name_selected,"onUpdate:modelValue":d[1]||(d[1]=r=>a.product_name_selected=r),placeholder:"\u4E8C\u7EA7\u6E38\u620F",class:"m-2",onChange:a.getDataById},{default:c(()=>[(w(!0),V(S,null,T(a.suboptions,r=>(w(),U(C,{key:r.product_id,label:r.product_name,value:r.product_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),e(n,{modelValue:a.dateRange,"onUpdate:modelValue":d[2]||(d[2]=r=>a.dateRange=r),type:"daterange","range-separator":"\u2192",onChange:a.handleDate,"start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F"},null,8,["modelValue","onChange"]),e(o,{type:"primary",onClick:d[3]||(d[3]=r=>a.withDrawRecord(a.main_product_name_selected,a.product_name_selected,a.query.product_id))},{default:c(()=>[ba]),_:1}),e(o,{type:"primary",onClick:a.goback},{default:c(()=>[fa]),_:1},8,["onClick"])]),e(i,{model:a.widthdrawDetail,inline:!0},{default:c(()=>[e(g,{label:"\u672A\u5BA1\u8BA2\u5355\u6570"},{default:c(()=>[b(Y(a.widthdrawDetail.unaudit_orders_count),1)]),_:1}),e(g,{label:"\u7533\u8BF7\u4EBA\u6570"},{default:c(()=>[b(Y(a.widthdrawDetail.apply_users_count),1)]),_:1}),e(g,{label:"\u672A\u5BA1\u603B\u91D1\u989D"},{default:c(()=>[b(Y(a.widthdrawDetail.unaudit_reward_sum),1)]),_:1})]),_:1},8,["model"]),e(Z,{data:a.tableData,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:c(()=>[e(p,{prop:"wechat_user_id",label:"\u7528\u6237ID"}),e(p,{prop:"main_product_name",label:"\u7236\u6E38\u620F"}),e(p,{prop:"product_name",label:"\u5B50\u6E38\u620F"}),e(p,{prop:"nickname",label:"\u7528\u6237\u540D"}),e(p,{prop:"bind_account_count",label:"\u8BBE\u5907\u5173\u8054\u8D26\u53F7"}),e(p,{prop:"amount",label:"\u7533\u8BF7\u63D0\u73B0\u91D1\u989D"}),e(p,{prop:"oaid",label:"\u6570\u76DFid"}),e(p,{prop:"ip",label:"ip"}),e(p,{prop:"ip_address",label:"ip\u5730\u5740"}),e(p,{prop:"updated_at",sortable:"",label:"\u7533\u8BF7\u65F6\u95F4"}),e(p,{label:"\u64CD\u4F5C",width:"220",align:"center"},{default:c(r=>[e(o,{type:"text",icon:"el-icon-link",onClick:I=>q.withdrawDetail(r.row.wechat_user_id)},{default:c(()=>[ga]),_:2},1032,["onClick"]),A(e(o,{type:"text",class:"agree",icon:"el-icon-edit",onClick:I=>a.handleOk(r.row.id)},{default:c(()=>[va]),_:2},1032,["onClick"]),[[O,r.row.status==1]]),A(e(o,{type:"text",class:"red",icon:"el-icon-delete",onClick:I=>a.handleDelete(r.row.id)},{default:c(()=>[wa]),_:2},1032,["onClick"]),[[O,r.row.status==1]])]),_:1})]),_:1},8,["data"]),k("div",Da,[e(N,{background:"",layout:"total, prev, pager, next","current-page":a.query.page_index,"page-size":a.query.page_size,total:a.pageTotal,onCurrentChange:a.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])])])}var Pa=$(_a,[["render",ka],["__scopeId","data-v-3cbb45a1"]]);export{Pa as default};
