import{_ as L,C as z,u as I,r as n,D as E,e as c,g as K,a as k,c as S,t as R,j as t,k as r,h as $,q as j,p as q,F as G,m as H,z as m,v as Q,l as V}from"./index.3fee5d13.js";import{h as W,f as X,i as Y}from"./privilelge.a8609542.js";const Z={class:"crumbs"},ee=m("\u6743\u9650\u7BA1\u7406"),le=m("\u6DFB\u52A0\u8D26\u53F7"),ae={class:"container"},te=m("\u53D6\u6D88"),re=m("\u4FDD\u5B58"),oe={__name:"AccountAdd",setup(se){const A=z();I();const y=n(!0),C=n(!0),s=E({username:"",password:"",nickname:"",admin_role_id:"",main_product_id:"",product_id:""}),N=n([]);n([]);const f=n(),J=()=>{W().then(a=>{a.status==200&&(console.log(a),C.value=!1,N.value=a.data.products.map(l=>({value:l.id,label:l.main_product_name,children:l.children.map(o=>({value:o.id,label:o.product_name,parent_id:l.id}))})))}).catch(a=>{console.log(a)})};n(),n(!1),n([]),n(!0);const x=n(),O=E({username:[{required:!0,message:"\u8BF7\u586B\u5199\u7528\u6237\u540D",trigger:"blur"}],password:[{required:!0,message:"\u8BF7\u586B\u5199\u5BC6\u7801",trigger:"blur"}],nickname:[{required:!0,message:"\u8BF7\u8F93\u5165\u6635\u79F0",trigger:"blur"}],admin_role_id:[{required:!0,message:"\u8BF7\u9009\u62E9\u89D2\u8272",trigger:"change"}],productTree:[{required:!0,validator:(a,l,o)=>{let d=f.value.getCheckedKeys(!1,!0);d.length==0||!d?o(new Error("\u8BF7\u9009\u62E9\u529F\u80FD\u6743\u9650\u8BBE\u7F6E")):o()},trigger:"change"}]}),T=a=>{Y(a).then(l=>{l.status==200?(V.success("\u6DFB\u52A0\u6210\u529F"),A.push({name:"privilegelist"})):V.error("\u6DFB\u52A0\u5931\u8D25,"+l.message)}).catch(l=>{V.error("\u6DFB\u52A0\u5931\u8D25"+l)})},D=n([]),U=(a,l)=>{let o=JSON.parse(JSON.stringify(f.value.getCheckedNodes(!1,!0))),d=[],i=[];o.forEach(e=>{e.children?d.push(e):i.push(e)});let u=[];d.forEach(e=>{let b=0;i.forEach(M=>{e.value==M.parent_id&&b++}),b==e.children.length&&u.push(e)});let h=[];u.forEach(e=>{e.children.forEach(b=>{h.push(b.value)})});let _=[],g=[];o.forEach(e=>{e.children?_.push(e.value):g.push(e.value)});let p=[];g.forEach(e=>{h.includes(e)||p.push(e)}),console.log(_,p);const w=_.join(","),v=p.join(",");s.main_product_id=w,s.product_id=v},B=()=>{X().then(a=>{a.status==200&&(y.value=!1,a.data.lists,console.log(a.data.lists),D.value=a.data.lists)})},F=()=>{A.go(-1)},P=a=>{a.validate((l,o)=>{if(l){JSON.parse(JSON.stringify(f.value.getCheckedNodes(!1,!0)));let d=JSON.parse(JSON.stringify(s));T(d)}else console.log("error submit!",o)})};return J(),B(),(a,l)=>{const o=c("el-breadcrumb-item"),d=c("el-breadcrumb"),i=c("el-input"),u=c("el-form-item"),h=c("el-radio"),_=c("el-radio-group"),g=c("el-tree"),p=c("el-button"),w=c("el-form"),v=K("loading");return k(),S("div",null,[R("div",Z,[t(d,{separator:"/"},{default:r(()=>[t(o,null,{default:r(()=>[ee]),_:1}),t(o,null,{default:r(()=>[le]),_:1})]),_:1})]),R("div",ae,[t(w,{model:s,"label-width":"100px",style:{width:"400px"},"status-icon":"",ref_key:"ruleFormRef",ref:x,rules:O},{default:r(()=>[t(u,{prop:"username",label:"\u7528\u6237\u540D"},{default:r(()=>[t(i,{modelValue:s.username,"onUpdate:modelValue":l[0]||(l[0]=e=>s.username=e),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",clearable:""},null,8,["modelValue"])]),_:1}),t(u,{prop:"password",label:"\u5BC6\u7801"},{default:r(()=>[t(i,{modelValue:s.password,"onUpdate:modelValue":l[1]||(l[1]=e=>s.password=e),type:"password",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801","show-password":""},null,8,["modelValue"])]),_:1}),t(u,{prop:"nickname",label:"\u6635\u79F0"},{default:r(()=>[t(i,{modelValue:s.nickname,"onUpdate:modelValue":l[2]||(l[2]=e=>s.nickname=e),placeholder:"\u8BF7\u8F93\u5165\u6635\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),t(u,{prop:"admin_role_id",label:"\u89D2\u8272"},{default:r(()=>[$(' <el-checkbox v-model="checkAll" :indeterminate="isIndeterminate" @change="handleAllChange">\u5168\u9009</el-checkbox> '),j((k(),q(_,{modelValue:s.admin_role_id,"onUpdate:modelValue":l[3]||(l[3]=e=>s.admin_role_id=e)},{default:r(()=>[(k(!0),S(G,null,H(D.value,e=>(k(),q(h,{key:e.id,label:e.id},{default:r(()=>[m(Q(e.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])),[[v,y.value]])]),_:1}),t(u,{prop:"productTree",label:"\u5E94\u7528"},{default:r(()=>[j(t(g,{ref_key:"treeRef",ref:f,data:N.value,multiple:"","show-checkbox":"","node-key":"value",onCheck:U},null,8,["data"]),[[v,C.value]])]),_:1}),t(u,null,{default:r(()=>[t(p,{onClick:F},{default:r(()=>[te]),_:1}),t(p,{type:"primary",onClick:l[4]||(l[4]=e=>P(x.value))},{default:r(()=>[re]),_:1})]),_:1})]),_:1},8,["model","rules"])])])}}},ce=L(oe,[["__file","/Users/apple/Desktop/project-b/relationship.b/src/views/privilegeManagement/AccountAdd.vue"]]);export{ce as default};
