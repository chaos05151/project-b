import{_ as O,g as s,f as U,o as f,c as C,a as y,b as t,w as n,bw as v,bx as Q,e as g,r,U as Y,aJ as A,a4 as M}from"./index.27a7b396.js";import{i as R,j as W,k as X,l as Z}from"./product.e1329e0e.js";import{h as w}from"./moment.9709ab41.js";import"./request.9d852b1a.js";const m=s(""),u=s(""),$=s(""),_=U({page_index:1,page_size:10}),ee=s(0),q=s([]),N=s(0),ae=s(""),le=s("\u4E00\u7EA7\u6E38\u620F"),te=U({}),c=U({}),H=s([]),I=s([]),j=s([]),E=s([]),ne=()=>{R().then(o=>{o.status==200?(H.value=o.data.games,u.value=H.value[0].value,I.value=o.data.channels,j.value=o.data.games,E.value=o.data.channels):o.message?v.error(o.message):v.error("\u540E\u7AEFapi\u63A5\u53E3\u5F02\u5E38\uFF01")}).catch(()=>{})},B=o=>o?/^([0-9]\d|[0-9])(.([0-9]\d|\d)){2}$/.test(o)?!0:(v.error("\u7248\u672C\u53F7\u683C\u5F0F\u4E3A\u6570\u5B57\u5982:x.x.x"),!1):(v.error("\u8BF7\u9009\u62E9\u6E38\u620F\uFF01"),!1),p=o=>{W(o).then(e=>{e.status==200?(q.value=e.data.lists.map(i=>({...i,created_at:w(i.created_at).format("YYYY-MM-DD HH:mm:ss"),uptime:w(i.uptime).format("YYYY-MM-DD HH:mm:ss")})),N.value=e.data.total_count):v.error(e==null?void 0:e.message)}).catch(()=>{})},oe=o=>{Z(o).then(e=>{if(e.status==200){v.success("\u6DFB\u52A0\u7248\u672C\u6210\u529F"),m.value="";const i={product_id:u.value,..._};p(i)}else v.error(e==null?void 0:e.message)})},L=o=>{X(o).then(e=>{if(e.status==200){v.success("\u5220\u9664\u7248\u672C\u6210\u529F"),m.value="";const i={product_id:u.value,..._};p(i)}})},de={name:"basetable",setup(){m.value="";const o={product_id:u.value,..._};p(o),ne();const e=()=>{_.pageIndex=1,p(_)},i=d=>{_.page_index=d,b()},l=d=>{Q.confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F","\u63D0\u793A",{type:"warning"}).then(()=>{L(d)}).catch(()=>{})},z=s(!1),k=s(!1),x=()=>{k.value=!0},T=()=>{if(k.value=!1,c.add_uptime&&c.add_uptime<w().format("YYYY-MM-DD HH:mm:ss")){v.error("\u9884\u671F\u4E0A\u7EBF\u65F6\u95F4\u4E0D\u80FD\u5728\u5F53\u524D\u65F6\u95F4\u4E4B\u524D\uFF01");return}if(!B(c.add_versions_b)||!B(c.add_versions_c))return;const d={product_id:c.add_product_name_selected,channel:c.add_channel_name_selected,versions_b:c.add_versions_b,versions_c:c.add_versions_c,uptime:c.add_uptime?c.add_uptime:w().format("YYYY-MM-DD HH:mm:ss")};oe(d)},h=()=>{b()},b=()=>{if(u.value==-1&&m.value==-1)p(_);else if(u.value==-1&&m.value!=-1){const d={channel:m.value,..._};p(d)}else if(u.value!=-1&&m.value==-1){const d={product_id:u.value,..._};p(d)}else if(u.value||m.value){const d={product_id:u.value,channel:m.value,..._};p(d)}else p(_)};return{query:_,tableData:q,pageTotal:N,editVisible:z,addVisible:k,form:te,formAdd:c,handleSearch:e,handlePageChange:i,handleDelete:l,handleAdd:x,saveAdd:T,deleteVersionTabData:L,product_type:le,productoptions:H,channeloptions:I,addproductoptions:j,addchanneloptions:E,channel_name_selected:m,product_name_selected:u,main_product_value_select:ae,check_main_product_name:ee,add_channel_name_selected_label:$,getData:p,getProductAndDataList:h,getChannelAndDataList:b}}},se={class:"crumbs"},re=g("\u98CE\u63A7\u7CFB\u7EDF"),_e=g("\u7248\u672C\u7BA1\u7406"),ce={class:"container"},ue={class:"handle-box"},ie=g("\xA0\xA0 "),me=g("\u65B0\u589E\u7248\u672C"),pe=g("\u5220\u9664 "),fe={class:"pagination"},ve={class:"dialog-footer"},be=g("\u53D6 \u6D88"),he=g("\u786E \u5B9A");function ge(o,e,i,l,z,k){const x=r("el-breadcrumb-item"),T=r("el-breadcrumb"),h=r("el-option"),b=r("el-select"),d=r("el-button"),V=r("el-table-column"),F=r("el-table"),J=r("el-pagination"),D=r("el-form-item"),P=r("el-input"),S=r("el-date-picker"),G=r("el-form"),K=r("el-dialog");return f(),C("div",null,[y("div",se,[t(T,{separator:"/"},{default:n(()=>[t(x,null,{default:n(()=>[re]),_:1}),t(x,null,{default:n(()=>[_e]),_:1})]),_:1})]),y("div",ce,[y("div",ue,[t(b,{modelValue:l.product_name_selected,"onUpdate:modelValue":e[0]||(e[0]=a=>l.product_name_selected=a),placeholder:"\u6E38\u620F\u9009\u62E9",class:"m-2",onChange:l.getProductAndDataList},{default:n(()=>[(f(!0),C(Y,null,A(l.productoptions,a=>(f(),M(h,{key:a.value,label:a.label_name,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),t(b,{modelValue:l.channel_name_selected,"onUpdate:modelValue":e[1]||(e[1]=a=>l.channel_name_selected=a),placeholder:"\u6E20\u9053\u9009\u62E9",class:"m-2",onChange:l.getChannelAndDataList},{default:n(()=>[t(h,{label:"\u5168\u90E8",value:"-1"}),(f(!0),C(Y,null,A(l.channeloptions,a=>(f(),M(h,{key:a.value,label:a.label_name,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),ie,t(d,{type:"primary",onClick:l.handleAdd},{default:n(()=>[me]),_:1},8,["onClick"])]),t(F,{data:l.tableData,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:n(()=>[t(V,{prop:"channel_name",label:"\u6E20\u9053\u4FE1\u606F"}),t(V,{prop:"versions_b",label:"\u540E\u7AEF\u7248\u672C"}),t(V,{prop:"created_at",label:"\u521B\u5EFA\u65F6\u95F4"}),t(V,{prop:"versions_c",label:"\u524D\u7AEF\u6700\u65B0\u7248\u672C"}),t(V,{prop:"uptime",label:"\u9884\u671F\u4E0A\u7EBF\u65F6\u95F4"}),t(V,{label:"\u64CD\u4F5C"},{default:n(a=>[t(d,{size:"small",type:"danger",onClick:Ve=>l.handleDelete(a.row.id)},{default:n(()=>[pe]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),y("div",fe,[t(J,{background:"",layout:"total, prev, pager, next","current-page":l.query.page_index,"page-size":l.query.page_size,total:l.pageTotal,onCurrentChange:l.handlePageChange},null,8,["current-page","page-size","total","onCurrentChange"])])]),t(K,{title:"\u65B0\u589E\u7248\u672C",modelValue:l.addVisible,"onUpdate:modelValue":e[8]||(e[8]=a=>l.addVisible=a),width:"60%"},{footer:n(()=>[y("span",ve,[t(d,{onClick:e[7]||(e[7]=a=>l.addVisible=!1)},{default:n(()=>[be]),_:1}),t(d,{type:"primary",onClick:l.saveAdd},{default:n(()=>[he]),_:1},8,["onClick"])])]),default:n(()=>[t(G,{"label-width":"110px"},{default:n(()=>[t(D,{label:"\u6E38\u620F\u9009\u62E9"},{default:n(()=>[t(b,{style:{width:"18%"},modelValue:l.formAdd.add_product_name_selected,"onUpdate:modelValue":e[2]||(e[2]=a=>l.formAdd.add_product_name_selected=a),placeholder:"\u6E38\u620F\u9009\u62E9",class:"m-2"},{default:n(()=>[(f(!0),C(Y,null,A(l.addproductoptions,a=>(f(),M(h,{key:a.value,label:a.label_name,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(D,{label:"\u6E20\u9053\u9009\u62E9"},{default:n(()=>[t(b,{ref:"add_channel_name_selected_label",style:{width:"18%"},modelValue:l.formAdd.add_channel_name_selected,"onUpdate:modelValue":e[3]||(e[3]=a=>l.formAdd.add_channel_name_selected=a),placeholder:"\u6E38\u620F\u9009\u62E9",class:"m-2"},{default:n(()=>[(f(!0),C(Y,null,A(l.addchanneloptions,a=>(f(),M(h,{key:a.value,label:a.label_name,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(D,{label:"\u540E\u53F0\u7248\u672C"},{default:n(()=>[t(P,{style:{width:"160px"},modelValue:l.formAdd.add_versions_b,"onUpdate:modelValue":e[4]||(e[4]=a=>l.formAdd.add_versions_b=a)},null,8,["modelValue"])]),_:1}),t(D,{label:"\u524D\u7AEF\u7248\u672C"},{default:n(()=>[t(P,{style:{width:"160px"},modelValue:l.formAdd.add_versions_c,"onUpdate:modelValue":e[5]||(e[5]=a=>l.formAdd.add_versions_c=a)},null,8,["modelValue"])]),_:1}),t(D,{label:"\u9884\u671F\u4E0A\u7EBF\u65F6\u95F4",prop:"uptime"},{default:n(()=>[t(S,{modelValue:l.formAdd.add_uptime,"onUpdate:modelValue":e[6]||(e[6]=a=>l.formAdd.add_uptime=a),type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var xe=O(de,[["render",ge],["__scopeId","data-v-32e362ba"]]);export{xe as default};
