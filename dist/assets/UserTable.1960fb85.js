import{_ as ce,u as ie,g as u,f as pe,r as v,o as m,c as C,a as Y,b as a,w as i,G as y,E as x,F as L,I as B,H as M,D as T,J as S,K as $,e as w,L as F}from"./index.95db1816.js";import{u as _e}from"./user.22cab16d.js";import{a as ve,b as me}from"./product.44e7e689.js";import{f as J,a as be,r as he}from"./user.d7ea680f.js";import{e as we}from"./export2excel.a0c92898.js";import{h as N}from"./moment.9709ab41.js";import"./request.0f196fd3.js";const fe={class:"crumbs"},ge=w("\u98CE\u63A7\u7CFB\u7EDF"),ke=w("\u7528\u6237\u7BA1\u7406"),ye={class:"container"},xe={class:"handle-box"},De=w("\u5BFC\u51FAExcel"),Ve=w("\u8BE6\u60C5 "),Ce=w(" \u52A0\u5165\u9ED1\u540D\u5355 "),Ye=w(" \u79FB\u51FA\u9ED1\u540D\u5355 "),Ue={class:"pagination"},Le={__name:"UserTable",setup(Be){const O=ie(),p=u(""),c=u(""),s=u("");u(0);const E=u([]),H=u([]),f=u(0),j=_e(),b=u(),g=u("");u(""),u("\u9879\u76EE");const D=u({}),t=pe({keywords:"",page_index:1,page_size:10});let I=u([]),P=u([]),A=u([{value:"-1",label:"\u5168\u90E8"},{value:"1",label:"\u5DF2\u63D0\u73B0\u7528\u6237"},{value:"0",label:"\u672A\u63D0\u73B0\u7528\u6237"}]);const r=e=>{J(e).then(o=>{o.status==200?(E.value=o.data.lists.map(_=>({..._,is_buy:_.is_buy==1?"\u662F":"\u5426",created_at:N(_.created_at).format("YYYY-MM-DD HH:mm:ss")})),f.value=o.data.total_count,D.value=JSON.parse(JSON.stringify(e)),console.log(D.value).catch(()=>{})):x.error(o==null?void 0:o.message)}).catch(()=>{})},R=()=>{p.value="",c.value="",s.value="",g.value="",t.keywords=""},q=()=>{ve().then(e=>{I.value=e.data}).catch(()=>{})},G=e=>{me({main_product_id:e}).then(_=>{P.value=_.data}).catch(()=>{})},K=e=>{be(e).then(o=>{o.status==200&&(x.success("\u52A0\u5165\u9ED1\u540D\u5355\u6210\u529F\uFF01"),r(t))}).catch(()=>{})},W=e=>{he(e).then(o=>{o.status==200&&(x.success("\u79FB\u51FA\u9ED1\u540D\u5355\u6210\u529F\uFF01"),r(t))}).catch(()=>{})},Q=()=>{console.log(b.value),b.value!=null?(t.start_date=b.value[0],t.end_date=b.value[1]):(delete t.start_date,delete t.end_date),console.log(t),r(t)};R(),q(),r(t);const X=e=>{F.confirm("\u786E\u5B9A\u52A0\u5165\u9ED1\u540D\u5355\uFF1F","\u63D0\u793A",{type:"warning"}).then(()=>{K(e)}).catch(()=>{})},Z=e=>{F.confirm("\u786E\u5B9A\u79FB\u51FA\u9ED1\u540D\u5355\uFF1F","\u63D0\u793A",{type:"warning"}).then(()=>{W(e)}).catch(()=>{})},h=()=>{if(p.value==-1)if(c.value==-1)if(s.value&&s.value>=0){const e={withdraw_user:s.value,...t};r(e)}else r(t);else if(c.value&&c.value>0)if(s.value&&s.value>=0){const e={product_id:c.value,withdraw_user:s.value,...t};r(e)}else{const e={product_id:c.value,...t};r(e)}else if(s.value&&s.value>=0){const e={withdraw_user:s.value,...t};r(e)}else r(t);else if(p.value&&p.value>0){if(c.value==-1)if(s.value&&s.value>=0){const e={main_product_id:p.value,withdraw_user:s.value,...t};r(e)}else{const e={main_product_id:p.value,...t};r(e)}else if(c.value&&c.value>0)if(s.value&&s.value>=0){const e={product_id:c.value,withdraw_user:s.value,...t};r(e)}else{const e={product_id:c.value,...t};r(e)}else if(s.value&&s.value>=0){const e={main_product_id:p.value,withdraw_user:s.value,...t};r(e)}else{const e={main_product_id:p.value,...t};r(e)}G(p.value)}else if(s.value&&s.value>=0){const e={withdraw_user:s.value,...t};r(e)}else r(t)},ee=()=>{h()},ae=()=>{h()},te=e=>{t.page_index=e,h()},le=()=>{g.value?(t.keywords=g.value,h()):(t.keywords="",h())},oe=e=>{O.push({name:"userdetail",params:{wechat_user_id:e}}),console.log(e),j.setuserDetail(e)},se=()=>{D.value.page_size=f.value?f.value<=1e4?f.value:1e4:10,J(D.value).then(e=>{if(e.status==200){H.value=e.data.lists.map(n=>({...n,is_buy:n.is_buy==1?"\u662F":"\u5426",created_at:N(n.created_at).format("YYYY-MM-DD HH:mm:ss")}));const o=["\u9879\u76EE","\u5E94\u7528","\u7528\u6237id","\u6570\u76DFid","\u662F\u5426\u4E70\u91CF\u7528\u6237","\u7528\u6237\u540D","\u624B\u673A\u53F7","\u7D2F\u79EF\u4F63\u91D1","\u5DF2\u63D0\u73B0\u4F63\u91D1","\u5DF2\u63D0\u73B0\u6B21\u6570","\u6CE8\u518Cip","ip\u5730\u5740","\u6CE8\u518C\u65F6\u95F4"],_=H.value.map(n=>({main_product_name:n.main_product_name,product_name:n.product_name,id:n.id,oaid:n.oaid,is_buy:n.is_buy==1?"\u662F":"\u5426",nickname:n.nickname,tel:n.tel,reward:n.reward,withdraw_reward:n.withdraw_reward,withdraw_times:n.withdraw_times,ip:n.ip,ip_address:n.ip_address,created_at:N(n.created_at).format("YYYY-MM-DD HH:mm:ss")}));we(_,"UserTable",o,"UserTable")}else e.message?x.error(e.message):x.error("\u540E\u7AEFapi\u63A5\u53E3\u5F02\u5E38\uFF01")})};return(e,o)=>{const _=v("el-breadcrumb-item"),n=v("el-breadcrumb"),k=v("el-option"),U=v("el-select"),ne=v("el-input"),re=v("el-date-picker"),V=v("el-button"),d=v("el-table-column"),ue=v("el-table"),de=v("el-pagination");return m(),C("div",null,[Y("div",fe,[a(n,{separator:"/"},{default:i(()=>[a(_,null,{default:i(()=>[ge]),_:1}),a(_,null,{default:i(()=>[ke]),_:1})]),_:1})]),Y("div",ye,[Y("div",xe,[a(U,{style:{width:"12%"},modelValue:p.value,"onUpdate:modelValue":o[0]||(o[0]=l=>p.value=l),placeholder:"\u9879\u76EE",class:"m-2",onChange:h},{default:i(()=>[a(k,{label:"\u5168\u90E8",value:"-1"}),(m(!0),C(L,null,B(T(I),l=>(m(),M(k,{key:l.id,label:l.main_product_name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(U,{style:{width:"12%"},modelValue:c.value,"onUpdate:modelValue":o[1]||(o[1]=l=>c.value=l),placeholder:"\u5E94\u7528",class:"m-2",onChange:ee},{default:i(()=>[a(k,{label:"\u5168\u90E8",value:"-1"}),(m(!0),C(L,null,B(T(P),l=>(m(),M(k,{key:l.product_id,label:l.product_name,value:l.product_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(U,{style:{width:"20%",margin:"0 5px"},modelValue:s.value,"onUpdate:modelValue":o[2]||(o[2]=l=>s.value=l),placeholder:"\u63D0\u73B0\u7528\u6237",class:"m-2",onChange:ae},{default:i(()=>[(m(!0),C(L,null,B(T(A),l=>(m(),M(k,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),a(ne,{modelValue:g.value,"onUpdate:modelValue":o[3]||(o[3]=l=>g.value=l),onInput:le,style:{width:"200px",padding:"0 5px"},class:"w-50 m-2",placeholder:"\u8BF7\u8F93\u5165id/\u7528\u6237\u540D/\u624B\u673A\u53F7/ip"},null,8,["modelValue"]),a(re,{style:{margin:"0 6px"},modelValue:b.value,"onUpdate:modelValue":o[4]||(o[4]=l=>b.value=l),type:"daterange","range-separator":"\u2192","start-placeholder":"\u5F00\u59CB\u65F6\u95F4","end-placeholder":"\u7ED3\u675F\u65F6\u95F4","value-format":"YYYY-MM-DD",onChange:Q},null,8,["modelValue"]),y(' <el-button type="primary" icon="el-icon-search" @click="handleSearch">\u641C\u7D22</el-button> '),y(' <el-button type="primary" @click="withDraw()">\u63D0\u73B0\u8BBE\u7F6E</el-button> '),y(' <el-button type="primary" @click="blackList()">\u67E5\u770B\u9ED1\u540D\u5355</el-button> '),y(' <el-button type="primary" @click="userFeedback()">\u7528\u6237\u53CD\u9988</el-button> '),a(V,{type:"primary",onClick:o[5]||(o[5]=l=>se())},{default:i(()=>[De]),_:1})]),a(ue,{data:E.value,border:"",class:"table",ref:"multipleTable","header-cell-class-name":"table-header"},{default:i(()=>[a(d,{prop:"main_product_name",label:"\u9879\u76EE"}),a(d,{prop:"product_name",label:"\u5E94\u7528"}),a(d,{prop:"id",label:"\u7528\u6237id"}),a(d,{prop:"oaid",label:"\u6570\u76DFid"}),a(d,{prop:"is_buy",label:"\u662F\u5426\u4E70\u91CF\u7528\u6237"}),a(d,{prop:"nickname",label:"\u7528\u6237\u540D"}),a(d,{prop:"tel",label:"\u624B\u673A\u53F7"}),a(d,{sortable:"",prop:"reward",label:"\u7D2F\u79EF\u4F63\u91D1"}),a(d,{sortable:"",prop:"withdraw_reward",label:"\u5DF2\u63D0\u73B0\u4F63\u91D1"}),a(d,{sortable:"",prop:"withdraw_times",label:"\u5DF2\u63D0\u73B0\u6B21\u6570"}),a(d,{prop:"ip",label:"\u6CE8\u518Cip"}),a(d,{prop:"ip_address",label:"ip\u5730\u5740"}),a(d,{prop:"created_at",label:"\u6CE8\u518C\u65F6\u95F4"}),y(` <el-table-column
          prop="bind_account_count"
          label="\u5173\u8054\u8D26\u53F7\u6570"
        ></el-table-column>
        <el-table-column prop="illegal_time" label="\u62C9\u9ED1\u65F6\u95F4"></el-table-column> `),a(d,{label:"\u64CD\u4F5C",width:"220",align:"center"},{default:i(l=>[a(V,{type:"text",icon:"el-icon-link",onClick:z=>oe(l.row.id)},{default:i(()=>[Ve]),_:2},1032,["onClick"]),S(a(V,{type:"text",icon:"el-icon-delete",class:"red",onClick:z=>X(l.row.id)},{default:i(()=>[Ce]),_:2},1032,["onClick"]),[[$,l.row.blacklisted!=1]]),S(a(V,{type:"text",icon:"el-icon-edit",onClick:z=>Z(l.row.id)},{default:i(()=>[Ye]),_:2},1032,["onClick"]),[[$,l.row.blacklisted==1]])]),_:1})]),_:1},8,["data"]),Y("div",Ue,[a(de,{background:"",layout:"total, prev, pager, next","current-page":t.page_index,"page-size":t.page_size,total:f.value,onCurrentChange:te},null,8,["current-page","page-size","total"])])])])}}},ze=ce(Le,[["__scopeId","data-v-4af0b479"],["__file","/Users/apple/Desktop/project-b github/project-b/src/views/UserTable.vue"]]);export{ze as default};
